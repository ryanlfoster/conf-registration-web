function createHttpBackendMock($rootScope,$delegate,$browser){function createResponse(status,data,headers){return angular.isFunction(status)?status:function(){return angular.isNumber(status)?[status,data,headers]:[200,status,data]}}function $httpBackend(method,url,data,callback,headers,timeout){function prettyPrint(data){return angular.isString(data)||angular.isFunction(data)||data instanceof RegExp?data:angular.toJson(data)}function wrapResponse(wrapped){function handleResponse(){var response=wrapped.response(method,url,data,headers);xhr.$$respHeaders=response[2],callback(response[0],response[1],xhr.getAllResponseHeaders())}function handleTimeout(){for(var i=0,ii=responses.length;ii>i;i++)if(responses[i]===handleResponse){responses.splice(i,1),callback(-1,void 0,"");break}}return!$browser&&timeout&&timeout.then&&timeout.then(handleTimeout),handleResponse}var xhr=new MockXhr,expectation=expectations[0],wasExpected=!1;if(expectation&&expectation.match(method,url)){if(!expectation.matchData(data))throw Error("Expected "+expectation+" with different data\nEXPECTED: "+prettyPrint(expectation.data)+"\nGOT:      "+data);if(!expectation.matchHeaders(headers))throw Error("Expected "+expectation+" with different headers\nEXPECTED: "+prettyPrint(expectation.headers)+"\nGOT:      "+prettyPrint(headers));if(expectations.shift(),expectation.response)return void responses.push(wrapResponse(expectation));wasExpected=!0}for(var definition,i=-1;definition=definitions[++i];)if(definition.match(method,url,data,headers||{})){if(definition.response)($browser?$browser.defer:responsesPush)(wrapResponse(definition));else{if(!definition.passThrough)throw Error("No response defined !");$delegate(method,url,data,callback,headers,timeout)}return}throw Error(wasExpected?"No response defined !":"Unexpected request: "+method+" "+url+"\n"+(expectation?"Expected "+expectation:"No more request expected"))}function createShortMethods(prefix){angular.forEach(["GET","DELETE","JSONP"],function(method){$httpBackend[prefix+method]=function(url,headers){return $httpBackend[prefix](method,url,void 0,headers)}}),angular.forEach(["PUT","POST","PATCH"],function(method){$httpBackend[prefix+method]=function(url,data,headers){return $httpBackend[prefix](method,url,data,headers)}})}var definitions=[],expectations=[],responses=[],responsesPush=angular.bind(responses,responses.push);return $httpBackend.when=function(method,url,data,headers){var definition=new MockHttpExpectation(method,url,data,headers),chain={respond:function(status,data,headers){definition.response=createResponse(status,data,headers)}};return $browser&&(chain.passThrough=function(){definition.passThrough=!0}),definitions.push(definition),chain},createShortMethods("when"),$httpBackend.expect=function(method,url,data,headers){var expectation=new MockHttpExpectation(method,url,data,headers);return expectations.push(expectation),{respond:function(status,data,headers){expectation.response=createResponse(status,data,headers)}}},createShortMethods("expect"),$httpBackend.flush=function(count){if($rootScope.$digest(),!responses.length)throw Error("No pending request to flush !");if(angular.isDefined(count))for(;count--;){if(!responses.length)throw Error("No more pending request to flush !");responses.shift()()}else for(;responses.length;)responses.shift()();$httpBackend.verifyNoOutstandingExpectation()},$httpBackend.verifyNoOutstandingExpectation=function(){if($rootScope.$digest(),expectations.length)throw Error("Unsatisfied requests: "+expectations.join(", "))},$httpBackend.verifyNoOutstandingRequest=function(){if(responses.length)throw Error("Unflushed requests: "+responses.length)},$httpBackend.resetExpectations=function(){expectations.length=0,responses.length=0},$httpBackend}function MockHttpExpectation(method,url,data,headers){this.data=data,this.headers=headers,this.match=function(m,u,d,h){return method!=m?!1:this.matchUrl(u)?angular.isDefined(d)&&!this.matchData(d)?!1:angular.isDefined(h)&&!this.matchHeaders(h)?!1:!0:!1},this.matchUrl=function(u){return url?angular.isFunction(url.test)?url.test(u):url==u:!0},this.matchHeaders=function(h){return angular.isUndefined(headers)?!0:angular.isFunction(headers)?headers(h):angular.equals(headers,h)},this.matchData=function(d){return angular.isUndefined(data)?!0:data&&angular.isFunction(data.test)?data.test(d):data&&!angular.isString(data)?angular.toJson(data)==d:data==d},this.toString=function(){return method+" "+url}}function MockXhr(){MockXhr.$$lastInstance=this,this.open=function(method,url,async){this.$$method=method,this.$$url=url,this.$$async=async,this.$$reqHeaders={},this.$$respHeaders={}},this.send=function(data){this.$$data=data},this.setRequestHeader=function(key,value){this.$$reqHeaders[key]=value},this.getResponseHeader=function(name){var header=this.$$respHeaders[name];return header?header:(name=angular.lowercase(name),(header=this.$$respHeaders[name])?header:(header=void 0,angular.forEach(this.$$respHeaders,function(headerVal,headerName){header||angular.lowercase(headerName)!=name||(header=headerVal)}),header))},this.getAllResponseHeaders=function(){var lines=[];return angular.forEach(this.$$respHeaders,function(value,key){lines.push(key+": "+value)}),lines.join("\n")},this.abort=angular.noop}!function(window,angular,undefined){"use strict";angular.module("ngResource",["ng"]).factory("$resource",["$http","$parse",function($http,$parse){function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function Route(template,defaults){this.template=template,this.defaults=defaults||{},this.urlParams={}}function ResourceFactory(url,paramDefaults,actions){function extractParams(data,actionParams){var ids={};return actionParams=extend({},paramDefaults,actionParams),forEach(actionParams,function(value,key){isFunction(value)&&(value=value()),ids[key]=value&&value.charAt&&"@"==value.charAt(0)?getter(data,value.substr(1)):value}),ids}function Resource(value){copy(value||{},this)}var route=new Route(url);return actions=extend({},DEFAULT_ACTIONS,actions),forEach(actions,function(action,name){action.method=angular.uppercase(action.method);var hasBody="POST"==action.method||"PUT"==action.method||"PATCH"==action.method;Resource[name]=function(a1,a2,a3,a4){function markResolved(){value.$resolved=!0}var data,promise,params={},success=noop,error=null;switch(arguments.length){case 4:error=a4,success=a3;case 3:case 2:if(!isFunction(a2)){params=a1,data=a2,success=a3;break}if(isFunction(a1)){success=a1,error=a2;break}success=a2,error=a3;case 1:isFunction(a1)?success=a1:hasBody?data=a1:params=a1;break;case 0:break;default:throw"Expected between 0-4 arguments [params, data, success, error], got "+arguments.length+" arguments."}var promise,value=this instanceof Resource?this:action.isArray?[]:new Resource(data),httpConfig={};return forEach(action,function(value,key){"params"!=key&&"isArray"!=key&&(httpConfig[key]=copy(value))}),httpConfig.data=data,route.setUrlParams(httpConfig,extend({},extractParams(data,action.params||{}),params),action.url),promise=$http(httpConfig),value.$resolved=!1,promise.then(markResolved,markResolved),value.$then=promise.then(function(response){var data=response.data,then=value.$then,resolved=value.$resolved;return data&&(action.isArray?(value.length=0,forEach(data,function(item){value.push(new Resource(item))})):(copy(data,value),value.$then=then,value.$resolved=resolved)),(success||noop)(value,response.headers),response.resource=value,response},error).then,value},Resource.prototype["$"+name]=function(a1,a2,a3){var error,params=extractParams(this),success=noop;switch(arguments.length){case 3:params=a1,success=a2,error=a3;break;case 2:case 1:isFunction(a1)?(success=a1,error=a2):(params=a1,success=a2||noop);case 0:break;default:throw"Expected between 1-3 arguments [params, success, error], got "+arguments.length+" arguments."}var data=hasBody?this:undefined;Resource[name].call(this,params,data,success,error)}}),Resource.bind=function(additionalParamDefaults){return ResourceFactory(url,extend({},paramDefaults,additionalParamDefaults),actions)},Resource}var DEFAULT_ACTIONS={get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}},noop=angular.noop,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,isFunction=angular.isFunction,getter=function(obj,path){return $parse(path)(obj)};return Route.prototype={setUrlParams:function(config,params,actionUrl){var val,encodedVal,self=this,url=actionUrl||self.template,urlParams=self.urlParams={};forEach(url.split(/\W/),function(param){param&&new RegExp("(^|[^\\\\]):"+param+"(\\W|$)").test(url)&&(urlParams[param]=!0)}),url=url.replace(/\\:/g,":"),params=params||{},forEach(self.urlParams,function(_,urlParam){val=params.hasOwnProperty(urlParam)?params[urlParam]:self.defaults[urlParam],angular.isDefined(val)&&null!==val?(encodedVal=encodeUriSegment(val),url=url.replace(new RegExp(":"+urlParam+"(\\W|$)","g"),encodedVal+"$1")):url=url.replace(new RegExp("(/?):"+urlParam+"(\\W|$)","g"),function(match,leadingSlashes,tail){return"/"==tail.charAt(0)?tail:leadingSlashes+tail})}),url=url.replace(/\/+$/,""),url=url.replace(/\/\.(?=\w+($|\?))/,"."),config.url=url.replace(/\/\\\./,"/."),forEach(params,function(value,key){self.urlParams[key]||(config.params=config.params||{},config.params[key]=value)})}},ResourceFactory}])}(window,window.angular),angular.mock={},angular.mock.$BrowserProvider=function(){this.$get=function(){return new angular.mock.$Browser}},angular.mock.$Browser=function(){var self=this;this.isMock=!0,self.$$url="http://server/",self.$$lastUrl=self.$$url,self.pollFns=[],self.$$completeOutstandingRequest=angular.noop,self.$$incOutstandingRequestCount=angular.noop,self.onUrlChange=function(listener){return self.pollFns.push(function(){self.$$lastUrl!=self.$$url&&(self.$$lastUrl=self.$$url,listener(self.$$url))}),listener},self.cookieHash={},self.lastCookieHash={},self.deferredFns=[],self.deferredNextId=0,self.defer=function(fn,delay){return delay=delay||0,self.deferredFns.push({time:self.defer.now+delay,fn:fn,id:self.deferredNextId}),self.deferredFns.sort(function(a,b){return a.time-b.time}),self.deferredNextId++},self.defer.now=0,self.defer.cancel=function(deferId){var fnIndex;return angular.forEach(self.deferredFns,function(fn,index){fn.id===deferId&&(fnIndex=index)}),void 0!==fnIndex?(self.deferredFns.splice(fnIndex,1),!0):!1},self.defer.flush=function(delay){if(angular.isDefined(delay))self.defer.now+=delay;else{if(!self.deferredFns.length)throw Error("No deferred tasks to be flushed");self.defer.now=self.deferredFns[self.deferredFns.length-1].time}for(;self.deferredFns.length&&self.deferredFns[0].time<=self.defer.now;)self.deferredFns.shift().fn()},self.$$baseHref="",self.baseHref=function(){return this.$$baseHref}},angular.mock.$Browser.prototype={poll:function(){angular.forEach(this.pollFns,function(pollFn){pollFn()})},addPollFn:function(pollFn){return this.pollFns.push(pollFn),pollFn},url:function(url){return url?(this.$$url=url,this):this.$$url},cookies:function(name,value){return name?void(void 0==value?delete this.cookieHash[name]:angular.isString(value)&&value.length<=4096&&(this.cookieHash[name]=value)):(angular.equals(this.cookieHash,this.lastCookieHash)||(this.lastCookieHash=angular.copy(this.cookieHash),this.cookieHash=angular.copy(this.cookieHash)),this.cookieHash)},notifyWhenNoOutstandingRequests:function(fn){fn()}},angular.mock.$ExceptionHandlerProvider=function(){var handler;this.mode=function(mode){switch(mode){case"rethrow":handler=function(e){throw e};break;case"log":var errors=[];handler=function(e){errors.push(1==arguments.length?e:[].slice.call(arguments,0))},handler.errors=errors;break;default:throw Error("Unknown mode '"+mode+"', only 'log'/'rethrow' modes are allowed!")}},this.$get=function(){return handler},this.mode("rethrow")},angular.mock.$LogProvider=function(){function concat(array1,array2,index){return array1.concat(Array.prototype.slice.call(array2,index))}this.$get=function(){var $log={log:function(){$log.log.logs.push(concat([],arguments,0))},warn:function(){$log.warn.logs.push(concat([],arguments,0))},info:function(){$log.info.logs.push(concat([],arguments,0))},error:function(){$log.error.logs.push(concat([],arguments,0))}};return $log.reset=function(){$log.log.logs=[],$log.warn.logs=[],$log.info.logs=[],$log.error.logs=[]},$log.assertEmpty=function(){var errors=[];if(angular.forEach(["error","warn","info","log"],function(logLevel){angular.forEach($log[logLevel].logs,function(log){angular.forEach(log,function(logItem){errors.push("MOCK $log ("+logLevel+"): "+String(logItem)+"\n"+(logItem.stack||""))})})}),errors.length)throw errors.unshift("Expected $log to be empty! Either a message was logged unexpectedly, or an expected log message was not checked and removed:"),errors.push(""),new Error(errors.join("\n---------\n"))},$log.reset(),$log}},function(){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8061_STR)){var date=new Date(0),tzHour=0,tzMin=0;return match[9]&&(tzHour=int(match[9]+match[10]),tzMin=int(match[9]+match[11])),date.setUTCFullYear(int(match[1]),int(match[2])-1,int(match[3])),date.setUTCHours(int(match[4]||0)-tzHour,int(match[5]||0)-tzMin,int(match[6]||0),int(match[7]||0)),date}return string}function int(str){return parseInt(str,10)}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;num.length<digits;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}var R_ISO8061_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?:\:?(\d\d)(?:\:?(\d\d)(?:\.(\d{3}))?)?)?(Z|([+-])(\d\d):?(\d\d)))?$/;angular.mock.TzDate=function(offset,timestamp){var self=new Date(0);if(angular.isString(timestamp)){var tsStr=timestamp;if(self.origDate=jsonStringToDate(timestamp),timestamp=self.origDate.getTime(),isNaN(timestamp))throw{name:"Illegal Argument",message:"Arg '"+tsStr+"' passed into TzDate constructor is not a valid date string"}}else self.origDate=new Date(timestamp);var localOffset=new Date(timestamp).getTimezoneOffset();self.offsetDiff=60*localOffset*1e3-1e3*offset*60*60,self.date=new Date(timestamp+self.offsetDiff),self.getTime=function(){return self.date.getTime()-self.offsetDiff},self.toLocaleDateString=function(){return self.date.toLocaleDateString()},self.getFullYear=function(){return self.date.getFullYear()},self.getMonth=function(){return self.date.getMonth()},self.getDate=function(){return self.date.getDate()},self.getHours=function(){return self.date.getHours()},self.getMinutes=function(){return self.date.getMinutes()},self.getSeconds=function(){return self.date.getSeconds()},self.getMilliseconds=function(){return self.date.getMilliseconds()},self.getTimezoneOffset=function(){return 60*offset},self.getUTCFullYear=function(){return self.origDate.getUTCFullYear()},self.getUTCMonth=function(){return self.origDate.getUTCMonth()},self.getUTCDate=function(){return self.origDate.getUTCDate()},self.getUTCHours=function(){return self.origDate.getUTCHours()},self.getUTCMinutes=function(){return self.origDate.getUTCMinutes()},self.getUTCSeconds=function(){return self.origDate.getUTCSeconds()},self.getUTCMilliseconds=function(){return self.origDate.getUTCMilliseconds()},self.getDay=function(){return self.date.getDay()},self.toISOString&&(self.toISOString=function(){return padNumber(self.origDate.getUTCFullYear(),4)+"-"+padNumber(self.origDate.getUTCMonth()+1,2)+"-"+padNumber(self.origDate.getUTCDate(),2)+"T"+padNumber(self.origDate.getUTCHours(),2)+":"+padNumber(self.origDate.getUTCMinutes(),2)+":"+padNumber(self.origDate.getUTCSeconds(),2)+"."+padNumber(self.origDate.getUTCMilliseconds(),3)+"Z"});var unimplementedMethods=["getUTCDay","getYear","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear","toDateString","toGMTString","toJSON","toLocaleFormat","toLocaleString","toLocaleTimeString","toSource","toString","toTimeString","toUTCString","valueOf"];return angular.forEach(unimplementedMethods,function(methodName){self[methodName]=function(){throw Error("Method '"+methodName+"' is not implemented in the TzDate mock")}}),self},angular.mock.TzDate.prototype=Date.prototype}(),angular.mock.createMockWindow=function(){var mockWindow={},setTimeoutQueue=[];return mockWindow.document=window.document,mockWindow.getComputedStyle=angular.bind(window,window.getComputedStyle),mockWindow.scrollTo=angular.bind(window,window.scrollTo),mockWindow.navigator=window.navigator,mockWindow.setTimeout=function(fn,delay){setTimeoutQueue.push({fn:fn,delay:delay})},mockWindow.setTimeout.queue=setTimeoutQueue,mockWindow.setTimeout.expect=function(delay){return setTimeoutQueue.length>0?{process:function(){var tick=setTimeoutQueue.shift();expect(tick.delay).toEqual(delay),tick.fn()}}:void expect("SetTimoutQueue empty. Expecting delay of ").toEqual(delay)},mockWindow},angular.mock.dump=function(object){function serialize(object){var out;return angular.isElement(object)?(object=angular.element(object),out=angular.element("<div></div>"),angular.forEach(object,function(element){out.append(angular.element(element).clone())}),out=out.html()):angular.isArray(object)?(out=[],angular.forEach(object,function(o){out.push(serialize(o))}),out="[ "+out.join(", ")+" ]"):out=angular.isObject(object)?angular.isFunction(object.$eval)&&angular.isFunction(object.$apply)?serializeScope(object):object instanceof Error?object.stack||""+object.name+": "+object.message:angular.toJson(object,!0):String(object),out}function serializeScope(scope,offset){offset=offset||"  ";var log=[offset+"Scope("+scope.$id+"): {"];for(var key in scope)scope.hasOwnProperty(key)&&!key.match(/^(\$|this)/)&&log.push("  "+key+": "+angular.toJson(scope[key]));for(var child=scope.$$childHead;child;)log.push(serializeScope(child,offset+"  ")),child=child.$$nextSibling;return log.push("}"),log.join("\n"+offset)}return serialize(object)},angular.mock.$HttpBackendProvider=function(){this.$get=["$rootScope",createHttpBackendMock]},angular.mock.$TimeoutDecorator=function($delegate,$browser){function formatPendingTasksAsString(tasks){var result=[];return angular.forEach(tasks,function(task){result.push("{id: "+task.id+", time: "+task.time+"}")}),result.join(", ")}return $delegate.flush=function(){$browser.defer.flush()},$delegate.verifyNoPendingTasks=function(){if($browser.deferredFns.length)throw Error("Deferred tasks to flush ("+$browser.deferredFns.length+"): "+formatPendingTasksAsString($browser.deferredFns))},$delegate},angular.mock.$RootElementProvider=function(){this.$get=function(){return angular.element("<div ng-app></div>")}},angular.module("ngMock",["ng"]).provider({$browser:angular.mock.$BrowserProvider,$exceptionHandler:angular.mock.$ExceptionHandlerProvider,$log:angular.mock.$LogProvider,$httpBackend:angular.mock.$HttpBackendProvider,$rootElement:angular.mock.$RootElementProvider}).config(function($provide){$provide.decorator("$timeout",angular.mock.$TimeoutDecorator)}),angular.module("ngMockE2E",["ng"]).config(["$provide",function($provide){$provide.decorator("$httpBackend",angular.mock.e2e.$httpBackendDecorator)}]),angular.mock.e2e={},angular.mock.e2e.$httpBackendDecorator=["$rootScope","$delegate","$browser",createHttpBackendMock],angular.mock.clearDataCache=function(){var key,cache=angular.element.cache;for(key in cache)if(cache.hasOwnProperty(key)){var handle=cache[key].handle;handle&&angular.element(handle.elem).unbind(),delete cache[key]}},window.jstestdriver&&function(window){window.dump=function(){var args=[];angular.forEach(arguments,function(arg){args.push(angular.mock.dump(arg))}),jstestdriver.console.log.apply(jstestdriver.console,args),window.console&&window.console.log.apply(window.console,args)}}(window),(window.jasmine||window.mocha)&&function(window){function isSpecRunning(){return currentSpec&&(window.mocha||currentSpec.queue.running)}var currentSpec=null;beforeEach(function(){currentSpec=this}),afterEach(function(){var injector=currentSpec.$injector;currentSpec.$injector=null,currentSpec.$modules=null,currentSpec=null,injector&&(injector.get("$rootElement").unbind(),injector.get("$browser").pollFns.length=0),angular.mock.clearDataCache(),angular.forEach(angular.element.fragments,function(val,key){delete angular.element.fragments[key]}),MockXhr.$$lastInstance=null,angular.forEach(angular.callbacks,function(val,key){delete angular.callbacks[key]}),angular.callbacks.counter=0}),window.module=angular.mock.module=function(){function workFn(){if(currentSpec.$injector)throw Error("Injector already created, can not register a module!");var modules=currentSpec.$modules||(currentSpec.$modules=[]);angular.forEach(moduleFns,function(module){modules.push(module)})}var moduleFns=Array.prototype.slice.call(arguments,0);return isSpecRunning()?workFn():workFn},window.inject=angular.mock.inject=function(){function workFn(){var modules=currentSpec.$modules||[];modules.unshift("ngMock"),modules.unshift("ng");var injector=currentSpec.$injector;injector||(injector=currentSpec.$injector=angular.injector(modules));for(var i=0,ii=blockFns.length;ii>i;i++)try{injector.invoke(blockFns[i]||angular.noop,this)}catch(e){throw e.stack&&errorForStack&&(e.stack+="\n"+errorForStack.stack),e}finally{errorForStack=null}}var blockFns=Array.prototype.slice.call(arguments,0),errorForStack=new Error("Declaration Location");return isSpecRunning()?workFn():workFn}}(window),function(window,angular,undefined){"use strict";angular.module("ngCookies",["ng"]).factory("$cookies",["$rootScope","$browser",function($rootScope,$browser){function push(){var name,value,browserCookies,updated;for(name in lastCookies)isUndefined(cookies[name])&&$browser.cookies(name,undefined);for(name in cookies)value=cookies[name],angular.isString(value)?value!==lastCookies[name]&&($browser.cookies(name,value),updated=!0):angular.isDefined(lastCookies[name])?cookies[name]=lastCookies[name]:delete cookies[name];if(updated){updated=!1,browserCookies=$browser.cookies();for(name in cookies)cookies[name]!==browserCookies[name]&&(isUndefined(browserCookies[name])?delete cookies[name]:cookies[name]=browserCookies[name],updated=!0)}}var lastBrowserCookies,cookies={},lastCookies={},runEval=!1,copy=angular.copy,isUndefined=angular.isUndefined;return $browser.addPollFn(function(){var currentCookies=$browser.cookies();lastBrowserCookies!=currentCookies&&(lastBrowserCookies=currentCookies,copy(currentCookies,lastCookies),copy(currentCookies,cookies),runEval&&$rootScope.$apply())})(),runEval=!0,$rootScope.$watch(push),cookies}]).factory("$cookieStore",["$cookies",function($cookies){return{get:function(key){var value=$cookies[key];return value?angular.fromJson(value):value},put:function(key,value){$cookies[key]=angular.toJson(value)},remove:function(key){delete $cookies[key]}}}])}(window,window.angular),function(window,angular){"use strict";function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function htmlParser(html,handler){function parseStartTag(tag,tagName,rest,unary){if(tagName=angular.lowercase(tagName),blockElements[tagName])for(;stack.last()&&inlineElements[stack.last()];)parseEndTag("",stack.last());optionalEndTagElements[tagName]&&stack.last()==tagName&&parseEndTag("",tagName),unary=voidElements[tagName]||!!unary,unary||stack.push(tagName);var attrs={};rest.replace(ATTR_REGEXP,function(match,name,doubleQuotedValue,singleQoutedValue,unqoutedValue){var value=doubleQuotedValue||singleQoutedValue||unqoutedValue||"";attrs[name]=decodeEntities(value)}),handler.start&&handler.start(tagName,attrs,unary)}function parseEndTag(tag,tagName){var i,pos=0;if(tagName=angular.lowercase(tagName))for(pos=stack.length-1;pos>=0&&stack[pos]!=tagName;pos--);if(pos>=0){for(i=stack.length-1;i>=pos;i--)handler.end&&handler.end(stack[i]);stack.length=pos}}var index,chars,match,stack=[],last=html;for(stack.last=function(){return stack[stack.length-1]};html;){if(chars=!0,stack.last()&&specialElements[stack.last()])html=html.replace(new RegExp("(.*)<\\s*\\/\\s*"+stack.last()+"[^>]*>","i"),function(all,text){return text=text.replace(COMMENT_REGEXP,"$1").replace(CDATA_REGEXP,"$1"),handler.chars&&handler.chars(decodeEntities(text)),""}),parseEndTag("",stack.last());else if(0===html.indexOf("<!--")?(index=html.indexOf("-->"),index>=0&&(handler.comment&&handler.comment(html.substring(4,index)),html=html.substring(index+3),chars=!1)):BEGING_END_TAGE_REGEXP.test(html)?(match=html.match(END_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(END_TAG_REGEXP,parseEndTag),chars=!1)):BEGIN_TAG_REGEXP.test(html)&&(match=html.match(START_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(START_TAG_REGEXP,parseStartTag),chars=!1)),chars){index=html.indexOf("<");var text=0>index?html:html.substring(0,index);html=0>index?"":html.substring(index),handler.chars&&handler.chars(decodeEntities(text))}if(html==last)throw"Parse Error: "+html;last=html}parseEndTag()}function decodeEntities(value){return hiddenPre.innerHTML=value.replace(/</g,"&lt;"),hiddenPre.innerText||hiddenPre.textContent||""}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriter(buf){var ignore=!1,out=angular.bind(buf,buf.push);return{start:function(tag,attrs,unary){tag=angular.lowercase(tag),!ignore&&specialElements[tag]&&(ignore=tag),ignore||1!=validElements[tag]||(out("<"),out(tag),angular.forEach(attrs,function(value,key){var lkey=angular.lowercase(key);1!=validAttrs[lkey]||uriAttrs[lkey]===!0&&!value.match(URI_REGEXP)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(unary?"/>":">"))},end:function(tag){tag=angular.lowercase(tag),ignore||1!=validElements[tag]||(out("</"),out(tag),out(">")),tag==ignore&&(ignore=!1)},chars:function(chars){ignore||out(encodeEntities(chars))}}}var $sanitize=function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf)),buf.join("")},START_TAG_REGEXP=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,END_TAG_REGEXP=/^<\s*\/\s*([\w:-]+)[^>]*>/,ATTR_REGEXP=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,BEGIN_TAG_REGEXP=/^</,BEGING_END_TAGE_REGEXP=/^<\s*\//,COMMENT_REGEXP=/<!--(.*?)-->/g,CDATA_REGEXP=/<!\[CDATA\[(.*?)]]>/g,URI_REGEXP=/^((ftp|https?):\/\/|mailto:|tel:|#)/,NON_ALPHANUMERIC_REGEXP=/([^\#-~| |!])/g,voidElements=makeMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=makeMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=makeMap("rp,rt"),optionalEndTagElements=angular.extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=angular.extend({},optionalEndTagBlockElements,makeMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),inlineElements=angular.extend({},optionalEndTagInlineElements,makeMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),specialElements=makeMap("script,style"),validElements=angular.extend({},voidElements,blockElements,inlineElements,optionalEndTagElements),uriAttrs=makeMap("background,cite,href,longdesc,src,usemap"),validAttrs=angular.extend({},uriAttrs,makeMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,span,start,summary,target,title,type,valign,value,vspace,width")),hiddenPre=document.createElement("pre");angular.module("ngSanitize",[]).value("$sanitize",$sanitize),angular.module("ngSanitize").directive("ngBindHtml",["$sanitize",function($sanitize){return function(scope,element,attr){element.addClass("ng-binding").data("$binding",attr.ngBindHtml),scope.$watch(attr.ngBindHtml,function(value){value=$sanitize(value),element.html(value||"")})}}]),angular.module("ngSanitize").filter("linky",function(){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s\.\;\,\(\)\{\}\<\>]/,MAILTO_REGEXP=/^mailto:/;return function(text,target){if(!text)return text;var match,url,i,raw=text,html=[],writer=htmlSanitizeWriter(html),properties={};for(angular.isDefined(target)&&(properties.target=target);match=raw.match(LINKY_URL_REGEXP);)url=match[0],match[2]==match[3]&&(url="mailto:"+url),i=match.index,writer.chars(raw.substr(0,i)),properties.href=url,writer.start("a",properties),writer.chars(match[0].replace(MAILTO_REGEXP,"")),writer.end("a"),raw=raw.substring(i+match[0].length);return writer.chars(raw),html.join("")}})}(window,window.angular),function(window){function basicIndexOf(array,value,fromIndex){for(var index=(fromIndex||0)-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}function cacheIndexOf(cache,value){var type=typeof value;if(cache=cache.cache,"boolean"==type||null==value)return cache[value];"number"!=type&&"string"!=type&&(type="object");var key="number"==type?value:keyPrefix+value;return cache=cache[type]||(cache[type]={}),"object"==type?cache[key]&&basicIndexOf(cache[key],value)>-1?0:-1:cache[key]?0:-1}function cachePush(value){var cache=this.cache,type=typeof value;if("boolean"==type||null==value)cache[value]=!0;else{"number"!=type&&"string"!=type&&(type="object");var key="number"==type?value:keyPrefix+value,typeCache=cache[type]||(cache[type]={});"object"==type?(typeCache[key]||(typeCache[key]=[])).push(value)==this.array.length&&(cache[type]=!1):typeCache[key]=!0}}function charAtCallback(value){return value.charCodeAt(0)}function compareAscending(a,b){var ai=a.index,bi=b.index;if(a=a.criteria,b=b.criteria,a!==b){if(a>b||"undefined"==typeof a)return 1;if(b>a||"undefined"==typeof b)return-1}return bi>ai?-1:1}function createCache(array){var index=-1,length=array.length,cache=getObject();cache["false"]=cache["null"]=cache["true"]=cache.undefined=!1;var result=getObject();for(result.array=array,result.cache=cache,result.push=cachePush;++index<length;)result.push(array[index]);return cache.object===!1?(releaseObject(result),null):result}function escapeStringChar(match){return"\\"+stringEscapes[match]}function getArray(){return arrayPool.pop()||[]}function getObject(){return objectPool.pop()||{args:"",array:null,bottom:"",cache:null,criteria:null,"false":!1,firstArg:"",index:0,init:"",leading:!1,loop:"",maxWait:0,"null":!1,number:null,object:null,push:null,shadowedProps:null,string:null,support:null,top:"",trailing:!1,"true":!1,undefined:!1,useHas:!1,useKeys:!1,value:null}}function isNode(value){return"function"!=typeof value.toString&&"string"==typeof(value+"")}function noop(){}function releaseArray(array){array.length=0,arrayPool.length<maxPoolSize&&arrayPool.push(array)}function releaseObject(object){var cache=object.cache;cache&&releaseObject(cache),object.array=object.cache=object.criteria=object.object=object.number=object.string=object.value=null,objectPool.length<maxPoolSize&&objectPool.push(object)}function slice(array,start,end){start||(start=0),"undefined"==typeof end&&(end=array?array.length:0);for(var index=-1,length=end-start||0,result=Array(0>length?0:length);++index<length;)result[index]=array[start+index];return result}function runInContext(context){function lodash(value){return value&&"object"==typeof value&&!isArray(value)&&hasOwnProperty.call(value,"__wrapped__")?value:new lodashWrapper(value)
}function lodashWrapper(value){this.__wrapped__=value}function createBound(func,thisArg,partialArgs,indicator){function bound(){var args=arguments,thisBinding=isPartial?this:thisArg;if(isFunc||(func=thisArg[key]),partialArgs.length&&(args=args.length?(args=nativeSlice.call(args),rightIndicator?args.concat(partialArgs):partialArgs.concat(args)):partialArgs),this instanceof bound){thisBinding=createObject(func.prototype);var result=func.apply(thisBinding,args);return isObject(result)?result:thisBinding}return func.apply(thisBinding,args)}var isFunc=isFunction(func),isPartial=!partialArgs,key=thisArg;if(isPartial){var rightIndicator=indicator;partialArgs=thisArg}else if(!isFunc){if(!indicator)throw new TypeError;thisArg=func}return bound}function createIterator(){var data=getObject();data.shadowedProps=shadowedProps,data.support=support,data.array=data.bottom=data.loop=data.top="",data.init="iterable",data.useHas=!0,data.useKeys=!!keys;for(var object,index=0;object=arguments[index];index++)for(var key in object)data[key]=object[key];var args=data.args;data.firstArg=/^[^,]+/.exec(args)[0];var factory=Function("errorClass, errorProto, hasOwnProperty, isArguments, isArray, isString, keys, lodash, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+args+") {\n"+iteratorTemplate(data)+"\n}");return releaseObject(data),factory(errorClass,errorProto,hasOwnProperty,isArguments,isArray,isString,keys,lodash,objectProto,objectTypes,nonEnumProps,stringClass,stringProto,toString)}function createObject(prototype){return isObject(prototype)?nativeCreate(prototype):{}}function escapeHtmlChar(match){return htmlEscapes[match]}function getIndexOf(){var result=(result=lodash.indexOf)===indexOf?basicIndexOf:result;return result}function overloadWrapper(func){return function(array,flag,callback,thisArg){return"boolean"!=typeof flag&&null!=flag&&(thisArg=callback,callback=thisArg&&thisArg[flag]===array?undefined:flag,flag=!1),null!=callback&&(callback=lodash.createCallback(callback,thisArg)),func(array,flag,callback,thisArg)}}function shimIsPlainObject(value){var ctor,result;return!value||toString.call(value)!=objectClass||(ctor=value.constructor,isFunction(ctor)&&!(ctor instanceof ctor))||!support.argsClass&&isArguments(value)||!support.nodeClass&&isNode(value)?!1:support.ownLast?(forIn(value,function(value,key,object){return result=hasOwnProperty.call(object,key),!1}),result!==!1):(forIn(value,function(value,key){result=key}),result===undefined||hasOwnProperty.call(value,result))}function unescapeHtmlChar(match){return htmlUnescapes[match]}function isArguments(value){return toString.call(value)==argsClass}function clone(value,deep,callback,thisArg,stackA,stackB){var result=value;if("boolean"!=typeof deep&&null!=deep&&(thisArg=callback,callback=deep,deep=!1),"function"==typeof callback){if(callback="undefined"==typeof thisArg?callback:lodash.createCallback(callback,thisArg,1),result=callback(result),"undefined"!=typeof result)return result;result=value}var isObj=isObject(result);if(isObj){var className=toString.call(result);if(!cloneableClasses[className]||!support.nodeClass&&isNode(result))return result;var isArr=isArray(result)}if(!isObj||!deep)return isObj?isArr?slice(result):assign({},result):result;var ctor=ctorByClass[className];switch(className){case boolClass:case dateClass:return new ctor(+result);case numberClass:case stringClass:return new ctor(result);case regexpClass:return ctor(result.source,reFlags.exec(result))}var initedStack=!stackA;stackA||(stackA=getArray()),stackB||(stackB=getArray());for(var length=stackA.length;length--;)if(stackA[length]==value)return stackB[length];return result=isArr?ctor(result.length):{},isArr&&(hasOwnProperty.call(value,"index")&&(result.index=value.index),hasOwnProperty.call(value,"input")&&(result.input=value.input)),stackA.push(value),stackB.push(result),(isArr?basicEach:forOwn)(value,function(objValue,key){result[key]=clone(objValue,deep,callback,undefined,stackA,stackB)}),initedStack&&(releaseArray(stackA),releaseArray(stackB)),result}function cloneDeep(value,callback,thisArg){return clone(value,!0,callback,thisArg)}function findKey(object,callback,thisArg){var result;return callback=lodash.createCallback(callback,thisArg),forOwn(object,function(value,key,object){return callback(value,key,object)?(result=key,!1):void 0}),result}function functions(object){var result=[];return forIn(object,function(value,key){isFunction(value)&&result.push(key)}),result.sort()}function has(object,property){return object?hasOwnProperty.call(object,property):!1}function invert(object){for(var index=-1,props=keys(object),length=props.length,result={};++index<length;){var key=props[index];result[object[key]]=key}return result}function isBoolean(value){return value===!0||value===!1||toString.call(value)==boolClass}function isDate(value){return value?"object"==typeof value&&toString.call(value)==dateClass:!1}function isElement(value){return value?1===value.nodeType:!1}function isEmpty(value){var result=!0;if(!value)return result;var className=toString.call(value),length=value.length;return className==arrayClass||className==stringClass||(support.argsClass?className==argsClass:isArguments(value))||className==objectClass&&"number"==typeof length&&isFunction(value.splice)?!length:(forOwn(value,function(){return result=!1}),result)}function isEqual(a,b,callback,thisArg,stackA,stackB){var whereIndicator=callback===indicatorObject;if("function"==typeof callback&&!whereIndicator){callback=lodash.createCallback(callback,thisArg,2);var result=callback(a,b);if("undefined"!=typeof result)return!!result}if(a===b)return 0!==a||1/a==1/b;var type=typeof a,otherType=typeof b;if(a===a&&(!a||"function"!=type&&"object"!=type)&&(!b||"function"!=otherType&&"object"!=otherType))return!1;if(null==a||null==b)return a===b;var className=toString.call(a),otherClass=toString.call(b);if(className==argsClass&&(className=objectClass),otherClass==argsClass&&(otherClass=objectClass),className!=otherClass)return!1;switch(className){case boolClass:case dateClass:return+a==+b;case numberClass:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case regexpClass:case stringClass:return a==String(b)}var isArr=className==arrayClass;if(!isArr){if(hasOwnProperty.call(a,"__wrapped__ ")||hasOwnProperty.call(b,"__wrapped__"))return isEqual(a.__wrapped__||a,b.__wrapped__||b,callback,thisArg,stackA,stackB);if(className!=objectClass||!support.nodeClass&&(isNode(a)||isNode(b)))return!1;var ctorA=!support.argsObject&&isArguments(a)?Object:a.constructor,ctorB=!support.argsObject&&isArguments(b)?Object:b.constructor;if(ctorA!=ctorB&&!(isFunction(ctorA)&&ctorA instanceof ctorA&&isFunction(ctorB)&&ctorB instanceof ctorB))return!1}var initedStack=!stackA;stackA||(stackA=getArray()),stackB||(stackB=getArray());for(var length=stackA.length;length--;)if(stackA[length]==a)return stackB[length]==b;var size=0;if(result=!0,stackA.push(a),stackB.push(b),isArr){if(length=a.length,size=b.length,result=size==a.length,!result&&!whereIndicator)return result;for(;size--;){var index=length,value=b[size];if(whereIndicator)for(;index--&&!(result=isEqual(a[index],value,callback,thisArg,stackA,stackB)););else if(!(result=isEqual(a[size],value,callback,thisArg,stackA,stackB)))break}return result}return forIn(b,function(value,key,b){return hasOwnProperty.call(b,key)?(size++,result=hasOwnProperty.call(a,key)&&isEqual(a[key],value,callback,thisArg,stackA,stackB)):void 0}),result&&!whereIndicator&&forIn(a,function(value,key,a){return hasOwnProperty.call(a,key)?result=--size>-1:void 0}),initedStack&&(releaseArray(stackA),releaseArray(stackB)),result}function isFinite(value){return nativeIsFinite(value)&&!nativeIsNaN(parseFloat(value))}function isFunction(value){return"function"==typeof value}function isObject(value){return!(!value||!objectTypes[typeof value])}function isNaN(value){return isNumber(value)&&value!=+value}function isNull(value){return null===value}function isNumber(value){return"number"==typeof value||toString.call(value)==numberClass}function isRegExp(value){return!(!value||!objectTypes[typeof value])&&toString.call(value)==regexpClass}function isString(value){return"string"==typeof value||toString.call(value)==stringClass}function isUndefined(value){return"undefined"==typeof value}function merge(object,source,deepIndicator){var args=arguments,index=0,length=2;if(!isObject(object))return object;if(deepIndicator===indicatorObject)var callback=args[3],stackA=args[4],stackB=args[5];else{var initedStack=!0;stackA=getArray(),stackB=getArray(),"number"!=typeof deepIndicator&&(length=args.length),length>3&&"function"==typeof args[length-2]?callback=lodash.createCallback(args[--length-1],args[length--],2):length>2&&"function"==typeof args[length-1]&&(callback=args[--length])}for(;++index<length;)(isArray(args[index])?forEach:forOwn)(args[index],function(source,key){var found,isArr,result=source,value=object[key];if(source&&((isArr=isArray(source))||isPlainObject(source))){for(var stackLength=stackA.length;stackLength--;)if(found=stackA[stackLength]==source){value=stackB[stackLength];break}if(!found){var isShallow;callback&&(result=callback(value,source),(isShallow="undefined"!=typeof result)&&(value=result)),isShallow||(value=isArr?isArray(value)?value:[]:isPlainObject(value)?value:{}),stackA.push(source),stackB.push(value),isShallow||(value=merge(value,source,indicatorObject,callback,stackA,stackB))}}else callback&&(result=callback(value,source),"undefined"==typeof result&&(result=source)),"undefined"!=typeof result&&(value=result);object[key]=value});return initedStack&&(releaseArray(stackA),releaseArray(stackB)),object}function omit(object,callback,thisArg){var indexOf=getIndexOf(),isFunc="function"==typeof callback,result={};if(isFunc)callback=lodash.createCallback(callback,thisArg);else var props=concat.apply(arrayRef,nativeSlice.call(arguments,1));return forIn(object,function(value,key,object){(isFunc?!callback(value,key,object):indexOf(props,key)<0)&&(result[key]=value)}),result}function pairs(object){for(var index=-1,props=keys(object),length=props.length,result=Array(length);++index<length;){var key=props[index];result[index]=[key,object[key]]}return result}function pick(object,callback,thisArg){var result={};if("function"!=typeof callback)for(var index=-1,props=concat.apply(arrayRef,nativeSlice.call(arguments,1)),length=isObject(object)?props.length:0;++index<length;){var key=props[index];key in object&&(result[key]=object[key])}else callback=lodash.createCallback(callback,thisArg),forIn(object,function(value,key,object){callback(value,key,object)&&(result[key]=value)});return result}function transform(object,callback,accumulator,thisArg){var isArr=isArray(object);if(callback=lodash.createCallback(callback,thisArg,4),null==accumulator)if(isArr)accumulator=[];else{var ctor=object&&object.constructor,proto=ctor&&ctor.prototype;accumulator=createObject(proto)}return(isArr?basicEach:forOwn)(object,function(value,index,object){return callback(accumulator,value,index,object)}),accumulator}function values(object){for(var index=-1,props=keys(object),length=props.length,result=Array(length);++index<length;)result[index]=object[props[index]];return result}function at(collection){var index=-1,props=concat.apply(arrayRef,nativeSlice.call(arguments,1)),length=props.length,result=Array(length);for(support.unindexedChars&&isString(collection)&&(collection=collection.split(""));++index<length;)result[index]=collection[props[index]];return result}function contains(collection,target,fromIndex){var index=-1,indexOf=getIndexOf(),length=collection?collection.length:0,result=!1;return fromIndex=(0>fromIndex?nativeMax(0,length+fromIndex):fromIndex)||0,length&&"number"==typeof length?result=(isString(collection)?collection.indexOf(target,fromIndex):indexOf(collection,target,fromIndex))>-1:basicEach(collection,function(value){return++index>=fromIndex?!(result=value===target):void 0}),result}function countBy(collection,callback,thisArg){var result={};return callback=lodash.createCallback(callback,thisArg),forEach(collection,function(value,key,collection){key=String(callback(value,key,collection)),hasOwnProperty.call(result,key)?result[key]++:result[key]=1}),result}function every(collection,callback,thisArg){var result=!0;if(callback=lodash.createCallback(callback,thisArg),isArray(collection))for(var index=-1,length=collection.length;++index<length&&(result=!!callback(collection[index],index,collection)););else basicEach(collection,function(value,index,collection){return result=!!callback(value,index,collection)});return result}function filter(collection,callback,thisArg){var result=[];if(callback=lodash.createCallback(callback,thisArg),isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];callback(value,index,collection)&&result.push(value)}else basicEach(collection,function(value,index,collection){callback(value,index,collection)&&result.push(value)});return result}function find(collection,callback,thisArg){if(callback=lodash.createCallback(callback,thisArg),!isArray(collection)){var result;return basicEach(collection,function(value,index,collection){return callback(value,index,collection)?(result=value,!1):void 0}),result}for(var index=-1,length=collection.length;++index<length;){var value=collection[index];if(callback(value,index,collection))return value}}function forEach(collection,callback,thisArg){if(callback&&"undefined"==typeof thisArg&&isArray(collection))for(var index=-1,length=collection.length;++index<length&&callback(collection[index],index,collection)!==!1;);else basicEach(collection,callback,thisArg);return collection}function groupBy(collection,callback,thisArg){var result={};return callback=lodash.createCallback(callback,thisArg),forEach(collection,function(value,key,collection){key=String(callback(value,key,collection)),(hasOwnProperty.call(result,key)?result[key]:result[key]=[]).push(value)}),result}function invoke(collection,methodName){var args=nativeSlice.call(arguments,2),index=-1,isFunc="function"==typeof methodName,length=collection?collection.length:0,result=Array("number"==typeof length?length:0);return forEach(collection,function(value){result[++index]=(isFunc?methodName:value[methodName]).apply(value,args)}),result}function map(collection,callback,thisArg){var index=-1,length=collection?collection.length:0,result=Array("number"==typeof length?length:0);if(callback=lodash.createCallback(callback,thisArg),isArray(collection))for(;++index<length;)result[index]=callback(collection[index],index,collection);else basicEach(collection,function(value,key,collection){result[++index]=callback(value,key,collection)});return result}function max(collection,callback,thisArg){var computed=-1/0,result=computed;if(!callback&&isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];value>result&&(result=value)}else callback=!callback&&isString(collection)?charAtCallback:lodash.createCallback(callback,thisArg),basicEach(collection,function(value,index,collection){var current=callback(value,index,collection);current>computed&&(computed=current,result=value)});return result}function min(collection,callback,thisArg){var computed=1/0,result=computed;if(!callback&&isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];result>value&&(result=value)}else callback=!callback&&isString(collection)?charAtCallback:lodash.createCallback(callback,thisArg),basicEach(collection,function(value,index,collection){var current=callback(value,index,collection);computed>current&&(computed=current,result=value)});return result}function reduce(collection,callback,accumulator,thisArg){var noaccum=arguments.length<3;if(callback=lodash.createCallback(callback,thisArg,4),isArray(collection)){var index=-1,length=collection.length;for(noaccum&&(accumulator=collection[++index]);++index<length;)accumulator=callback(accumulator,collection[index],index,collection)}else basicEach(collection,function(value,index,collection){accumulator=noaccum?(noaccum=!1,value):callback(accumulator,value,index,collection)});return accumulator}function reduceRight(collection,callback,accumulator,thisArg){var iterable=collection,length=collection?collection.length:0,noaccum=arguments.length<3;if("number"!=typeof length){var props=keys(collection);length=props.length}else support.unindexedChars&&isString(collection)&&(iterable=collection.split(""));return callback=lodash.createCallback(callback,thisArg,4),forEach(collection,function(value,index,collection){index=props?props[--length]:--length,accumulator=noaccum?(noaccum=!1,iterable[index]):callback(accumulator,iterable[index],index,collection)}),accumulator}function reject(collection,callback,thisArg){return callback=lodash.createCallback(callback,thisArg),filter(collection,function(value,index,collection){return!callback(value,index,collection)})}function shuffle(collection){var index=-1,length=collection?collection.length:0,result=Array("number"==typeof length?length:0);return forEach(collection,function(value){var rand=floor(nativeRandom()*(++index+1));result[index]=result[rand],result[rand]=value}),result}function size(collection){var length=collection?collection.length:0;return"number"==typeof length?length:keys(collection).length}function some(collection,callback,thisArg){var result;if(callback=lodash.createCallback(callback,thisArg),isArray(collection))for(var index=-1,length=collection.length;++index<length&&!(result=callback(collection[index],index,collection)););else basicEach(collection,function(value,index,collection){return!(result=callback(value,index,collection))});return!!result}function sortBy(collection,callback,thisArg){var index=-1,length=collection?collection.length:0,result=Array("number"==typeof length?length:0);for(callback=lodash.createCallback(callback,thisArg),forEach(collection,function(value,key,collection){var object=result[++index]=getObject();object.criteria=callback(value,key,collection),object.index=index,object.value=value}),length=result.length,result.sort(compareAscending);length--;){var object=result[length];result[length]=object.value,releaseObject(object)}return result}function toArray(collection){return collection&&"number"==typeof collection.length?support.unindexedChars&&isString(collection)?collection.split(""):slice(collection):values(collection)}function compact(array){for(var index=-1,length=array?array.length:0,result=[];++index<length;){var value=array[index];value&&result.push(value)}return result}function difference(array){var index=-1,indexOf=getIndexOf(),length=array?array.length:0,seen=concat.apply(arrayRef,nativeSlice.call(arguments,1)),result=[],isLarge=length>=largeArraySize&&indexOf===basicIndexOf;if(isLarge){var cache=createCache(seen);cache?(indexOf=cacheIndexOf,seen=cache):isLarge=!1}for(;++index<length;){var value=array[index];indexOf(seen,value)<0&&result.push(value)}return isLarge&&releaseObject(seen),result}function findIndex(array,callback,thisArg){var index=-1,length=array?array.length:0;for(callback=lodash.createCallback(callback,thisArg);++index<length;)if(callback(array[index],index,array))return index;return-1}function first(array,callback,thisArg){if(array){var n=0,length=array.length;if("number"!=typeof callback&&null!=callback){var index=-1;for(callback=lodash.createCallback(callback,thisArg);++index<length&&callback(array[index],index,array);)n++}else if(n=callback,null==n||thisArg)return array[0];return slice(array,0,nativeMin(nativeMax(0,n),length))}}function indexOf(array,value,fromIndex){if("number"==typeof fromIndex){var length=array?array.length:0;fromIndex=0>fromIndex?nativeMax(0,length+fromIndex):fromIndex||0}else if(fromIndex){var index=sortedIndex(array,value);return array[index]===value?index:-1}return array?basicIndexOf(array,value,fromIndex):-1}function initial(array,callback,thisArg){if(!array)return[];var n=0,length=array.length;if("number"!=typeof callback&&null!=callback){var index=length;for(callback=lodash.createCallback(callback,thisArg);index--&&callback(array[index],index,array);)n++}else n=null==callback||thisArg?1:callback||n;return slice(array,0,nativeMin(nativeMax(0,length-n),length))}function intersection(array){for(var args=arguments,argsLength=args.length,argsIndex=-1,caches=getArray(),index=-1,indexOf=getIndexOf(),length=array?array.length:0,result=[],seen=getArray();++argsIndex<argsLength;){var value=args[argsIndex];caches[argsIndex]=indexOf===basicIndexOf&&(value?value.length:0)>=largeArraySize&&createCache(argsIndex?args[argsIndex]:seen)}outer:for(;++index<length;){var cache=caches[0];if(value=array[index],(cache?cacheIndexOf(cache,value):indexOf(seen,value))<0){for(argsIndex=argsLength,(cache||seen).push(value);--argsIndex;)if(cache=caches[argsIndex],(cache?cacheIndexOf(cache,value):indexOf(args[argsIndex],value))<0)continue outer;result.push(value)}}for(;argsLength--;)cache=caches[argsLength],cache&&releaseObject(cache);return releaseArray(caches),releaseArray(seen),result}function last(array,callback,thisArg){if(array){var n=0,length=array.length;if("number"!=typeof callback&&null!=callback){var index=length;for(callback=lodash.createCallback(callback,thisArg);index--&&callback(array[index],index,array);)n++}else if(n=callback,null==n||thisArg)return array[length-1];return slice(array,nativeMax(0,length-n))}}function lastIndexOf(array,value,fromIndex){var index=array?array.length:0;for("number"==typeof fromIndex&&(index=(0>fromIndex?nativeMax(0,index+fromIndex):nativeMin(fromIndex,index-1))+1);index--;)if(array[index]===value)return index;return-1}function range(start,end,step){start=+start||0,step=+step||1,null==end&&(end=start,start=0);for(var index=-1,length=nativeMax(0,ceil((end-start)/step)),result=Array(length);++index<length;)result[index]=start,start+=step;return result}function rest(array,callback,thisArg){if("number"!=typeof callback&&null!=callback){var n=0,index=-1,length=array?array.length:0;for(callback=lodash.createCallback(callback,thisArg);++index<length&&callback(array[index],index,array);)n++}else n=null==callback||thisArg?1:nativeMax(0,callback);return slice(array,n)}function sortedIndex(array,value,callback,thisArg){var low=0,high=array?array.length:low;for(callback=callback?lodash.createCallback(callback,thisArg,1):identity,value=callback(value);high>low;){var mid=low+high>>>1;callback(array[mid])<value?low=mid+1:high=mid}return low}function union(array){return isArray(array)||(arguments[0]=array?nativeSlice.call(array):arrayRef),uniq(concat.apply(arrayRef,arguments))}function unzip(array){for(var index=-1,length=array?max(pluck(array,"length")):0,result=Array(0>length?0:length);++index<length;)result[index]=pluck(array,index);return result}function without(array){return difference(array,nativeSlice.call(arguments,1))}function zip(array){return array?unzip(arguments):[]}function zipObject(keys,values){for(var index=-1,length=keys?keys.length:0,result={};++index<length;){var key=keys[index];values?result[key]=values[index]:result[key[0]]=key[1]}return result}function after(n,func){return 1>n?func():function(){return--n<1?func.apply(this,arguments):void 0}}function bind(func,thisArg){return support.fastBind||nativeBind&&arguments.length>2?nativeBind.call.apply(nativeBind,arguments):createBound(func,thisArg,nativeSlice.call(arguments,2))}function bindAll(object){for(var funcs=arguments.length>1?concat.apply(arrayRef,nativeSlice.call(arguments,1)):functions(object),index=-1,length=funcs.length;++index<length;){var key=funcs[index];object[key]=bind(object[key],object)}return object}function bindKey(object,key){return createBound(object,key,nativeSlice.call(arguments,2),indicatorObject)}function compose(){var funcs=arguments;return function(){for(var args=arguments,length=funcs.length;length--;)args=[funcs[length].apply(this,args)];return args[0]}}function createCallback(func,thisArg,argCount){if(null==func)return identity;var type=typeof func;if("function"!=type){if("object"!=type)return function(object){return object[func]};var props=keys(func);return function(object){for(var length=props.length,result=!1;length--&&(result=isEqual(object[props[length]],func[props[length]],indicatorObject)););return result}}return"undefined"==typeof thisArg||reThis&&!reThis.test(fnToString.call(func))?func:1===argCount?function(value){return func.call(thisArg,value)}:2===argCount?function(a,b){return func.call(thisArg,a,b)}:4===argCount?function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)}:function(value,index,collection){return func.call(thisArg,value,index,collection)}}function debounce(func,wait,options){function clear(){clearTimeout(maxTimeoutId),clearTimeout(timeoutId),callCount=0,maxTimeoutId=timeoutId=null}function delayed(){var isCalled=trailing&&(!leading||callCount>1);clear(),isCalled&&(maxWait!==!1&&(lastCalled=new Date),result=func.apply(thisArg,args))}function maxDelayed(){clear(),(trailing||maxWait!==wait)&&(lastCalled=new Date,result=func.apply(thisArg,args))}var args,result,thisArg,callCount=0,lastCalled=0,maxWait=!1,maxTimeoutId=null,timeoutId=null,trailing=!0;if(wait=nativeMax(0,wait||0),options===!0){var leading=!0;trailing=!1}else isObject(options)&&(leading=options.leading,maxWait="maxWait"in options&&nativeMax(wait,options.maxWait||0),trailing="trailing"in options?options.trailing:trailing);return function(){if(args=arguments,thisArg=this,callCount++,clearTimeout(timeoutId),maxWait===!1)leading&&2>callCount&&(result=func.apply(thisArg,args));else{var now=new Date;maxTimeoutId||leading||(lastCalled=now);var remaining=maxWait-(now-lastCalled);0>=remaining?(clearTimeout(maxTimeoutId),maxTimeoutId=null,lastCalled=now,result=func.apply(thisArg,args)):maxTimeoutId||(maxTimeoutId=setTimeout(maxDelayed,remaining))}return wait!==maxWait&&(timeoutId=setTimeout(delayed,wait)),result}}function defer(func){var args=nativeSlice.call(arguments,1);return setTimeout(function(){func.apply(undefined,args)},1)}function delay(func,wait){var args=nativeSlice.call(arguments,2);return setTimeout(function(){func.apply(undefined,args)},wait)}function memoize(func,resolver){function memoized(){var cache=memoized.cache,key=keyPrefix+(resolver?resolver.apply(this,arguments):arguments[0]);return hasOwnProperty.call(cache,key)?cache[key]:cache[key]=func.apply(this,arguments)}return memoized.cache={},memoized}function once(func){var ran,result;return function(){return ran?result:(ran=!0,result=func.apply(this,arguments),func=null,result)}}function partial(func){return createBound(func,nativeSlice.call(arguments,1))}function partialRight(func){return createBound(func,nativeSlice.call(arguments,1),null,indicatorObject)}function throttle(func,wait,options){var leading=!0,trailing=!0;options===!1?leading=!1:isObject(options)&&(leading="leading"in options?options.leading:leading,trailing="trailing"in options?options.trailing:trailing),options=getObject(),options.leading=leading,options.maxWait=wait,options.trailing=trailing;var result=debounce(func,wait,options);return releaseObject(options),result}function wrap(value,wrapper){return function(){var args=[value];return push.apply(args,arguments),wrapper.apply(this,args)}}function escape(string){return null==string?"":String(string).replace(reUnescapedHtml,escapeHtmlChar)}function identity(value){return value}function mixin(object){forEach(functions(object),function(methodName){var func=lodash[methodName]=object[methodName];lodash.prototype[methodName]=function(){var value=this.__wrapped__,args=[value];push.apply(args,arguments);var result=func.apply(lodash,args);return value&&"object"==typeof value&&value===result?this:new lodashWrapper(result)}})}function noConflict(){return context._=oldDash,this}function random(min,max){null==min&&null==max&&(max=1),min=+min||0,null==max?(max=min,min=0):max=+max||0;var rand=nativeRandom();return min%1||max%1?min+nativeMin(rand*(max-min+parseFloat("1e-"+((rand+"").length-1))),max):min+floor(rand*(max-min+1))}function result(object,property){var value=object?object[property]:undefined;return isFunction(value)?object[property]():value}function template(text,data,options){var settings=lodash.templateSettings;text||(text=""),options=iteratorTemplate?defaults({},options,settings):settings;var isEvaluating,imports=iteratorTemplate&&defaults({},options.imports,settings.imports),importsKeys=iteratorTemplate?keys(imports):["_"],importsValues=iteratorTemplate?values(imports):[lodash],index=0,interpolate=options.interpolate||reNoMatch,source="__p += '",reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g");text.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){return interpolateValue||(interpolateValue=esTemplateValue),source+=text.slice(index,offset).replace(reUnescapedString,escapeStringChar),escapeValue&&(source+="' +\n__e("+escapeValue+") +\n'"),evaluateValue&&(isEvaluating=!0,source+="';\n"+evaluateValue+";\n__p += '"),interpolateValue&&(source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"),index=offset+match.length,match}),source+="';\n";var variable=options.variable,hasVariable=variable;hasVariable||(variable="obj",source="with ("+variable+") {\n"+source+"\n}\n"),source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),source="function("+variable+") {\n"+(hasVariable?"":variable+" || ("+variable+" = {});\n")+"var __t, __p = '', __e = _.escape"+(isEvaluating?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var sourceURL="\n/*\n//@ sourceURL="+(options.sourceURL||"/lodash/template/source["+templateCounter++ +"]")+"\n*/";try{var result=Function(importsKeys,"return "+source+sourceURL).apply(undefined,importsValues)}catch(e){throw e.source=source,e}return data?result(data):(result.source=source,result)}function times(n,callback,thisArg){n=(n=+n)>-1?n:0;var index=-1,result=Array(n);for(callback=lodash.createCallback(callback,thisArg,1);++index<n;)result[index]=callback(index);return result}function unescape(string){return null==string?"":String(string).replace(reEscapedHtml,unescapeHtmlChar)}function uniqueId(prefix){var id=++idCounter;return String(null==prefix?"":prefix)+id}function tap(value,interceptor){return interceptor(value),value}function wrapperToString(){return String(this.__wrapped__)}function wrapperValueOf(){return this.__wrapped__}context=context?_.defaults(window.Object(),context,_.pick(window,contextProps)):window;var Array=context.Array,Boolean=context.Boolean,Date=context.Date,Error=context.Error,Function=context.Function,Math=context.Math,Number=context.Number,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError,arrayRef=[],errorProto=Error.prototype,objectProto=Object.prototype,stringProto=String.prototype,oldDash=context._,reNative=RegExp("^"+String(objectProto.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),ceil=Math.ceil,clearTimeout=context.clearTimeout,concat=arrayRef.concat,floor=Math.floor,fnToString=Function.prototype.toString,getPrototypeOf=reNative.test(getPrototypeOf=Object.getPrototypeOf)&&getPrototypeOf,hasOwnProperty=objectProto.hasOwnProperty,push=arrayRef.push,propertyIsEnumerable=objectProto.propertyIsEnumerable,setImmediate=context.setImmediate,setTimeout=context.setTimeout,toString=objectProto.toString,nativeBind=reNative.test(nativeBind=toString.bind)&&nativeBind,nativeCreate=reNative.test(nativeCreate=Object.create)&&nativeCreate,nativeIsArray=reNative.test(nativeIsArray=Array.isArray)&&nativeIsArray,nativeIsFinite=context.isFinite,nativeIsNaN=context.isNaN,nativeKeys=reNative.test(nativeKeys=Object.keys)&&nativeKeys,nativeMax=Math.max,nativeMin=Math.min,nativeParseInt=context.parseInt,nativeRandom=Math.random,nativeSlice=arrayRef.slice,isIeOpera=reNative.test(context.attachEvent),isV8=nativeBind&&!/\n|true/.test(nativeBind+isIeOpera),ctorByClass={};
ctorByClass[arrayClass]=Array,ctorByClass[boolClass]=Boolean,ctorByClass[dateClass]=Date,ctorByClass[funcClass]=Function,ctorByClass[objectClass]=Object,ctorByClass[numberClass]=Number,ctorByClass[regexpClass]=RegExp,ctorByClass[stringClass]=String;var nonEnumProps={};nonEnumProps[arrayClass]=nonEnumProps[dateClass]=nonEnumProps[numberClass]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},nonEnumProps[boolClass]=nonEnumProps[stringClass]={constructor:!0,toString:!0,valueOf:!0},nonEnumProps[errorClass]=nonEnumProps[funcClass]=nonEnumProps[regexpClass]={constructor:!0,toString:!0},nonEnumProps[objectClass]={constructor:!0},function(){for(var length=shadowedProps.length;length--;){var prop=shadowedProps[length];for(var className in nonEnumProps)hasOwnProperty.call(nonEnumProps,className)&&!hasOwnProperty.call(nonEnumProps[className],prop)&&(nonEnumProps[className][prop]=!1)}}(),lodashWrapper.prototype=lodash.prototype;var support=lodash.support={};!function(){var ctor=function(){this.x=1},object={0:1,length:1},props=[];ctor.prototype={valueOf:1,y:1};for(var prop in new ctor)props.push(prop);for(prop in arguments);support.argsObject=arguments.constructor==Object&&!(arguments instanceof Array),support.argsClass=isArguments(arguments),support.enumErrorProps=propertyIsEnumerable.call(errorProto,"message")||propertyIsEnumerable.call(errorProto,"name"),support.enumPrototypes=propertyIsEnumerable.call(ctor,"prototype"),support.fastBind=nativeBind&&!isV8,support.ownLast="x"!=props[0],support.nonEnumArgs=0!=prop,support.nonEnumShadows=!/valueOf/.test(props),support.spliceObjects=(arrayRef.splice.call(object,0,1),!object[0]),support.unindexedChars="x"[0]+Object("x")[0]!="xx";try{support.nodeClass=!(toString.call(document)==objectClass&&!({toString:0}+""))}catch(e){support.nodeClass=!0}}(1),lodash.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:reInterpolate,variable:"",imports:{_:lodash}};var iteratorTemplate=template("var index, iterable = <%= firstArg %>, result = <%= init %>;\nif (!iterable) return result;\n<%= top %>;<% if (array) { %>\nvar length = iterable.length; index = -1;\nif (<%= array %>) {  <% if (support.unindexedChars) { %>\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  <% } %>\n  while (++index < length) {\n    <%= loop %>;\n  }\n}\nelse {  <% } else if (support.nonEnumArgs) { %>\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      <%= loop %>;\n    }\n  } else {  <% } %>  <% if (support.enumPrototypes) { %>\n  var skipProto = typeof iterable == 'function';\n  <% } %>  <% if (support.enumErrorProps) { %>\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  <% } %>  <%    var conditions = [];    if (support.enumPrototypes) { conditions.push('!(skipProto && index == \"prototype\")'); }    if (support.enumErrorProps)  { conditions.push('!(skipErrorProps && (index == \"message\" || index == \"name\"))'); }  %>  <% if (useHas && useKeys) { %>\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n<%    if (conditions.length) { %>    if (<%= conditions.join(' && ') %>) {\n  <% } %>    <%= loop %>;    <% if (conditions.length) { %>\n    }<% } %>\n  }  <% } else { %>\n  for (index in iterable) {\n<%    if (useHas) { conditions.push(\"hasOwnProperty.call(iterable, index)\"); }    if (conditions.length) { %>    if (<%= conditions.join(' && ') %>) {\n  <% } %>    <%= loop %>;    <% if (conditions.length) { %>\n    }<% } %>\n  }    <% if (support.nonEnumShadows) { %>\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      <% for (k = 0; k < 7; k++) { %>\n    index = '<%= shadowedProps[k] %>';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))<%        if (!useHas) { %> || (!nonEnum[index] && iterable[index] !== objectProto[index])<% }      %>) {\n      <%= loop %>;\n    }      <% } %>\n  }    <% } %>  <% } %>  <% if (array || support.nonEnumArgs) { %>\n}<% } %>\n<%= bottom %>;\nreturn result"),defaultsIteratorOptions={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},eachIteratorOptions={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : lodash.createCallback(callback, thisArg)",array:"typeof length == 'number'",loop:"if (callback(iterable[index], index, collection) === false) return result"},forOwnIteratorOptions={top:"if (!objectTypes[typeof iterable]) return result;\n"+eachIteratorOptions.top,array:!1};if(!nativeCreate)var createObject=function(prototype){if(isObject(prototype)){noop.prototype=prototype;var result=new noop;noop.prototype=null}return result||{}};support.argsClass||(isArguments=function(value){return value?hasOwnProperty.call(value,"callee"):!1});var isArray=nativeIsArray||function(value){return value?"object"==typeof value&&toString.call(value)==arrayClass:!1},shimKeys=createIterator({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),keys=nativeKeys?function(object){return isObject(object)?support.enumPrototypes&&"function"==typeof object||support.nonEnumArgs&&object.length&&isArguments(object)?shimKeys(object):nativeKeys(object):[]}:shimKeys,basicEach=createIterator(eachIteratorOptions),htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},htmlUnescapes=invert(htmlEscapes),assign=createIterator(defaultsIteratorOptions,{top:defaultsIteratorOptions.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = lodash.createCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),defaults=createIterator(defaultsIteratorOptions),forIn=createIterator(eachIteratorOptions,forOwnIteratorOptions,{useHas:!1}),forOwn=createIterator(eachIteratorOptions,forOwnIteratorOptions);isFunction(/x/)&&(isFunction=function(value){return"function"==typeof value&&toString.call(value)==funcClass});var isPlainObject=getPrototypeOf?function(value){if(!value||toString.call(value)!=objectClass||!support.argsClass&&isArguments(value))return!1;var valueOf=value.valueOf,objProto="function"==typeof valueOf&&(objProto=getPrototypeOf(valueOf))&&getPrototypeOf(objProto);return objProto?value==objProto||getPrototypeOf(value)==objProto:shimIsPlainObject(value)}:shimIsPlainObject,pluck=map,where=filter,flatten=overloadWrapper(function flatten(array,isShallow,callback){for(var index=-1,length=array?array.length:0,result=[];++index<length;){var value=array[index];callback&&(value=callback(value,index,array)),isArray(value)?push.apply(result,isShallow?value:flatten(value)):result.push(value)}return result}),uniq=overloadWrapper(function(array,isSorted,callback){var index=-1,indexOf=getIndexOf(),length=array?array.length:0,result=[],isLarge=!isSorted&&length>=largeArraySize&&indexOf===basicIndexOf,seen=callback||isLarge?getArray():result;if(isLarge){var cache=createCache(seen);cache?(indexOf=cacheIndexOf,seen=cache):(isLarge=!1,seen=callback?seen:(releaseArray(seen),result))}for(;++index<length;){var value=array[index],computed=callback?callback(value,index,array):value;(isSorted?!index||seen[seen.length-1]!==computed:indexOf(seen,computed)<0)&&((callback||isLarge)&&seen.push(computed),result.push(value))}return isLarge?(releaseArray(seen.array),releaseObject(seen)):callback&&releaseArray(seen),result});isV8&&freeModule&&"function"==typeof setImmediate&&(defer=bind(setImmediate,context));var parseInt=8==nativeParseInt(whitespace+"08")?nativeParseInt:function(value,radix){return nativeParseInt(isString(value)?value.replace(reLeadingSpacesAndZeros,""):value,radix||0)};return lodash.after=after,lodash.assign=assign,lodash.at=at,lodash.bind=bind,lodash.bindAll=bindAll,lodash.bindKey=bindKey,lodash.compact=compact,lodash.compose=compose,lodash.countBy=countBy,lodash.createCallback=createCallback,lodash.debounce=debounce,lodash.defaults=defaults,lodash.defer=defer,lodash.delay=delay,lodash.difference=difference,lodash.filter=filter,lodash.flatten=flatten,lodash.forEach=forEach,lodash.forIn=forIn,lodash.forOwn=forOwn,lodash.functions=functions,lodash.groupBy=groupBy,lodash.initial=initial,lodash.intersection=intersection,lodash.invert=invert,lodash.invoke=invoke,lodash.keys=keys,lodash.map=map,lodash.max=max,lodash.memoize=memoize,lodash.merge=merge,lodash.min=min,lodash.omit=omit,lodash.once=once,lodash.pairs=pairs,lodash.partial=partial,lodash.partialRight=partialRight,lodash.pick=pick,lodash.pluck=pluck,lodash.range=range,lodash.reject=reject,lodash.rest=rest,lodash.shuffle=shuffle,lodash.sortBy=sortBy,lodash.tap=tap,lodash.throttle=throttle,lodash.times=times,lodash.toArray=toArray,lodash.transform=transform,lodash.union=union,lodash.uniq=uniq,lodash.unzip=unzip,lodash.values=values,lodash.where=where,lodash.without=without,lodash.wrap=wrap,lodash.zip=zip,lodash.zipObject=zipObject,lodash.collect=map,lodash.drop=rest,lodash.each=forEach,lodash.extend=assign,lodash.methods=functions,lodash.object=zipObject,lodash.select=filter,lodash.tail=rest,lodash.unique=uniq,mixin(lodash),lodash.chain=lodash,lodash.prototype.chain=function(){return this},lodash.clone=clone,lodash.cloneDeep=cloneDeep,lodash.contains=contains,lodash.escape=escape,lodash.every=every,lodash.find=find,lodash.findIndex=findIndex,lodash.findKey=findKey,lodash.has=has,lodash.identity=identity,lodash.indexOf=indexOf,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isBoolean=isBoolean,lodash.isDate=isDate,lodash.isElement=isElement,lodash.isEmpty=isEmpty,lodash.isEqual=isEqual,lodash.isFinite=isFinite,lodash.isFunction=isFunction,lodash.isNaN=isNaN,lodash.isNull=isNull,lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isPlainObject=isPlainObject,lodash.isRegExp=isRegExp,lodash.isString=isString,lodash.isUndefined=isUndefined,lodash.lastIndexOf=lastIndexOf,lodash.mixin=mixin,lodash.noConflict=noConflict,lodash.parseInt=parseInt,lodash.random=random,lodash.reduce=reduce,lodash.reduceRight=reduceRight,lodash.result=result,lodash.runInContext=runInContext,lodash.size=size,lodash.some=some,lodash.sortedIndex=sortedIndex,lodash.template=template,lodash.unescape=unescape,lodash.uniqueId=uniqueId,lodash.all=every,lodash.any=some,lodash.detect=find,lodash.findWhere=find,lodash.foldl=reduce,lodash.foldr=reduceRight,lodash.include=contains,lodash.inject=reduce,forOwn(lodash,function(func,methodName){lodash.prototype[methodName]||(lodash.prototype[methodName]=function(){var args=[this.__wrapped__];return push.apply(args,arguments),func.apply(lodash,args)})}),lodash.first=first,lodash.last=last,lodash.take=first,lodash.head=first,forOwn(lodash,function(func,methodName){lodash.prototype[methodName]||(lodash.prototype[methodName]=function(callback,thisArg){var result=func(this.__wrapped__,callback,thisArg);return null==callback||thisArg&&"function"!=typeof callback?result:new lodashWrapper(result)})}),lodash.VERSION="1.3.1",lodash.prototype.toString=wrapperToString,lodash.prototype.value=wrapperValueOf,lodash.prototype.valueOf=wrapperValueOf,basicEach(["join","pop","shift"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return func.apply(this.__wrapped__,arguments)}}),basicEach(["push","reverse","sort","unshift"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return func.apply(this.__wrapped__,arguments),this}}),basicEach(["concat","slice","splice"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return new lodashWrapper(func.apply(this.__wrapped__,arguments))}}),support.spliceObjects||basicEach(["pop","shift","splice"],function(methodName){var func=arrayRef[methodName],isSplice="splice"==methodName;lodash.prototype[methodName]=function(){var value=this.__wrapped__,result=func.apply(value,arguments);return 0===value.length&&delete value[0],isSplice?new lodashWrapper(result):result}}),lodash._basicEach=basicEach,lodash._iteratorTemplate=iteratorTemplate,lodash._shimKeys=shimKeys,lodash}var undefined,arrayPool=[],objectPool=[],idCounter=0,indicatorObject={},keyPrefix=+new Date+"",largeArraySize=75,maxPoolSize=40,reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reEscapedHtml=/&(?:amp|lt|gt|quot|#39);/g,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reFlags=/\w*$/,reInterpolate=/<%=([\s\S]+?)%>/g,reThis=(reThis=/\bthis\b/)&&reThis.test(runInContext)&&reThis,whitespace=" 	\f\n\r\u2028\u2029",reLeadingSpacesAndZeros=RegExp("^["+whitespace+"]*0+(?=.$)"),reNoMatch=/($^)/,reUnescapedHtml=/[&<>"']/g,reUnescapedString=/['\n\r\t\u2028\u2029\\]/g,contextProps=["Array","Boolean","Date","Error","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],shadowedProps=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],templateCounter=0,argsClass="[object Arguments]",arrayClass="[object Array]",boolClass="[object Boolean]",dateClass="[object Date]",errorClass="[object Error]",funcClass="[object Function]",numberClass="[object Number]",objectClass="[object Object]",regexpClass="[object RegExp]",stringClass="[object String]",cloneableClasses={};cloneableClasses[funcClass]=!1,cloneableClasses[argsClass]=cloneableClasses[arrayClass]=cloneableClasses[boolClass]=cloneableClasses[dateClass]=cloneableClasses[numberClass]=cloneableClasses[objectClass]=cloneableClasses[regexpClass]=cloneableClasses[stringClass]=!0;var objectTypes={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},freeExports=objectTypes[typeof exports]&&exports,freeModule=objectTypes[typeof module]&&module&&module.exports==freeExports&&module,freeGlobal=objectTypes[typeof global]&&global;!freeGlobal||freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal||(window=freeGlobal);var _=runInContext();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(window._=_,define(function(){return _})):freeExports&&!freeExports.nodeType?freeModule?(freeModule.exports=_)._=_:freeExports._=_:window._=_}(this),angular.module("confRegistrationWebApp").factory("currentRegistrationInterceptor",["$q","$injector",function($q,$injector){return{responseError:function(rejection){var regExp=/conferences\/[-a-zA-Z0-9]+\/registrations\/current\/?$/;if(404===rejection.status&&regExp.test(rejection.config.url)){var url=rejection.config.url.split("/");return _.isEmpty(_.last(url))&&url.pop(),url.pop(),$injector.get("$http").post(url.join("/"),{})}return $q.reject(rejection)}}}]),angular.module("confRegistrationWebApp").factory("authorizationInterceptor",["$cookies",function($cookies){return{request:function(config){return config.headers.PreviousAuthorization=$cookies.crsPreviousToken,config.headers.Authorization=$cookies.crsToken,config.withCredentials=!0,config}}}]),angular.module("confRegistrationWebApp").factory("unauthorizedInterceptor",["$q","$cookies",function($q,$cookies){return{responseError:function(rejection){return _.contains([401,0],rejection.status)&&angular.isDefined($cookies.crsToken)&&(delete $cookies.crsToken,location.reload()),$q.reject(rejection)}}}]),angular.module("confRegistrationWebApp").factory("statusInterceptor",function(){return{response:function(response){return _.isUndefined(response.data.statusCode)||(response.status=response.data.statusCode),response}}}),angular.module("confRegistrationWebApp").factory("debouncePutsInterceptor",["$timeout",function($timeout){var waitingRequests={},passThrough=function(config){var fn=function(){waitingRequests[config.url].holdRequests=!1};waitingRequests[config.url]={holdRequests:!0,timer:$timeout(fn,200)}},holdRequest=function(config){$timeout.cancel(waitingRequests[config.url].timer);var fn=function(){return waitingRequests[config.url].holdRequests=!1,config};return waitingRequests[config.url].timer=$timeout(fn,200),waitingRequests[config.url].timer};return{request:function(config){var deferredConfig;return"PUT"===config.method&&(waitingRequests[config.url]&&waitingRequests[config.url].holdRequests?deferredConfig=holdRequest(config):passThrough(config)),deferredConfig||config}}}]),angular.module("confRegistrationWebApp").constant("uuid",function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0,v="x"==c?r:3&r|8;return v.toString(16)})}),angular.module("confRegistrationWebApp").constant("apiUrl","http://CRS-elb-2069964056.us-east-1.elb.amazonaws.com:8080/crs-http-json-api/rest/"),angular.module("confRegistrationWebApp").factory("httpUrlInterceptor",["apiUrl",function(apiUrl){return{request:function(config){var passthroughRegexs=[/https?:\/\/.*/,/views\/.*/,/template\/.*/],match=function(regexp){return regexp.test(config.url)};return _.any(passthroughRegexs,match)||(config.url=apiUrl+config.url),config}}}]),angular.module("confRegistrationWebApp").service("GrowlService",["$rootScope","Model","$timeout",function($rootScope,Model,$timeout){var growlPath,growlObject,growlTimeout;this.growl=function(path,object,message){growlPath=path,growlObject=angular.copy(object),$rootScope.growlMessage=message,$timeout.cancel(growlTimeout),growlTimeout=$timeout(function(){$rootScope.growlMessage=""},5e3)},$rootScope.growlUndo=function(){Model.update(growlPath,growlObject),$rootScope.growlMessage="",$timeout.cancel(growlTimeout)}}]),angular.module("confRegistrationWebApp").controller("RegistrationCtrl",["$scope","$rootScope","conference","currentRegistration","$routeParams","$location",function($scope,$rootScope,conference,currentRegistration,$routeParams,$location){function getPageById(pageId){for(var pages=conference.registrationPages,i=0;i<pages.length;i++)if(angular.equals(pageId,pages[i].id))return pages[i]}function getPageAfterById(pageId){for(var pages=conference.registrationPages,i=0;i<pages.length;i++)if(angular.equals(pageId,pages[i].id))return pages[i+1]}$scope.validPages={},$scope.$on("pageValid",function(event,validity){event.stopPropagation(),$scope.validPages[event.targetScope.page.id]=validity,$scope.registrationComplete=_.filter($scope.validPages).length===conference.registrationPages.length}),$scope.currentRegistration=currentRegistration,$scope.conference=conference,currentRegistration.completed&&($scope.currentRegistration.remainingBalance=currentRegistration.totalDue,currentRegistration.pastPayments.forEach(function(payment){$scope.currentRegistration.remainingBalance-=payment.amount}));var pageId=$routeParams.pageId;$scope.activePageId=pageId,$scope.page=getPageById(pageId),$scope.activePageIndex=_.findIndex(conference.registrationPages,{id:pageId}),$scope.nextPage=getPageAfterById(pageId),$scope.validateAndGoToNext=function(){$location.path("/register/"+conference.id+"/page/"+$scope.nextPage.id)},$scope.goToReviewOrPayment=function(){$location.path(conference.acceptCreditCards&&_.isUndefined($rootScope.currentPayment)?"/payment/"+conference.id:"/reviewRegistration/"+conference.id)}}]),angular.module("confRegistrationWebApp").directive("page",function(){return{templateUrl:"views/pageDirective.html",restrict:"E",controller:["$scope","$location",function($scope,$location){$scope.wizard=-1!==$location.path().indexOf("wizard"),$scope.$watch("pageForm.$valid",function(valid){$scope.$emit("pageValid",valid)})}]}}),angular.module("confRegistrationWebApp").directive("crsBlock",function(){return{templateUrl:"views/blockDirective.html",restrict:"A",controller:["$scope","AnswerCache","RegistrationCache","uuid",function($scope,AnswerCache,RegistrationCache,uuid){$scope.wizard||(RegistrationCache.getCurrent($scope.conference.id).then(function(currentRegistration){var answerForThisBlock=_.where(currentRegistration.answers,{blockId:$scope.block.id});answerForThisBlock.length>0&&($scope.answer=answerForThisBlock[0]),angular.isUndefined($scope.answer)&&($scope.answer={id:uuid(),registrationId:currentRegistration.id,blockId:$scope.block.id,value:{}},currentRegistration.answers.push($scope.answer))}),AnswerCache.syncBlock($scope,"answer")),$scope.editBlockAddOption=function(){angular.isUndefined($scope.this.block.content.choices)&&($scope.this.block.content={choices:[]}),$.inArray($scope.$$childTail.editBlockAddOptionValue,$scope.this.block.content.choices)>=0||($scope.this.block.content.choices.push($scope.$$childTail.editBlockAddOptionValue),$scope.$$childTail.editBlockAddOptionValue="",console.log($scope.this.block.content.choices))},$scope.editBlockDeleteOption=function(index){$scope.this.block.content.choices.splice(index,1),console.log($scope.this.block.content.choices)}}]}}),angular.module("confRegistrationWebApp").directive("crsSigninBox",function(){return{templateUrl:"views/crsSigninBox.html",restrict:"E",controller:["$scope","$document","Model","apiUrl",function($scope,$document,Model,apiUrl){$scope.document=$document,$scope.apiUrl=apiUrl,Model.subscribe($scope,"profileData","profile")}],link:function(scope,element){scope.openBox=function(){scope.crsSigninBoxStatus=!scope.crsSigninBoxStatus},scope.document.bind("click",function(){scope.$apply("crsSigninBoxStatus = false")}),element.bind("click",function(event){event.stopPropagation()})}}}),angular.module("confRegistrationWebApp").controller("EditAnswerDialogCtrl",["$scope","$modalInstance",function($scope,$modalInstance){$scope.originalAnswer=angular.copy($scope.answer),$scope.close=function(){$scope.$parent.answer=angular.copy($scope.originalAnswer),$modalInstance.close("")},$scope.submit=function(){$modalInstance.close()}}]),angular.module("confRegistrationWebApp").controller("AdminDataCtrl",["$scope","registrations","conference","$modal",function($scope,registrations,conference,$modal){$scope.conference=conference,$scope.blocks=[],$scope.reversesort=!1,registrations=_.filter(registrations,function(item){return item.completed!==!1}),angular.forEach(conference.registrationPages,function(page){angular.forEach(page.blocks,function(block){-1===block.type.indexOf("Content")&&(block.visible=!0,$scope.blocks.push(block))})}),$scope.toggleColumn=function(block){$scope.blocks[block].visible=!$scope.blocks[block].visible},$scope.findAnswer=function(registration,blockId){return _.find(registration.answers,function(answer){return angular.equals(answer.blockId,blockId)})},$scope.getSelectedCheckboxes=function(choices){return _.keys(_.pick(choices,function(val){return val===!0}))},$scope.answerSort=function(registration){return angular.isDefined($scope.order)?angular.isDefined($scope.findAnswer(registration,$scope.order))?$scope.findAnswer(registration,$scope.order).value.text?$scope.findAnswer(registration,$scope.order).value.text:$scope.getSelectedCheckboxes($scope.findAnswer(registration,$scope.order).value).length>0?$scope.getSelectedCheckboxes($scope.findAnswer(registration,$scope.order).value).join(" "):"object"==typeof $scope.findAnswer(registration,$scope.order).value?_.values($scope.findAnswer(registration,$scope.order).value).join(" "):$scope.findAnswer(registration,$scope.order).value:void 0:0},$scope.setOrder=function(order){$scope.reversesort=order===$scope.order?!$scope.reversesort:!1,$scope.order=order},$scope.registrations=registrations,$scope.viewPayments=function(registrationId){var registrationPayments=_.filter(registrations,function(item){return item.id===registrationId});registrationPayments=registrationPayments[0].pastPayments,console.log(registrationPayments);var paymentModalOptions={templateUrl:"views/paymentsModal.html",controller:"errorModal",backdrop:"static",keyboard:!1,resolve:{message:function(){return registrationPayments}}};$modal.open(paymentModalOptions).result.then(function(){})}}]),angular.module("confRegistrationWebApp").controller("AdminDetailsCtrl",["$scope","$timeout","Model","conference",function($scope,$timeout,Model,conference){Model.subscribe($scope,"conference","conferences/"+conference.id)}]),angular.module("confRegistrationWebApp").controller("ReviewRegistrationCtrl",["$scope","$rootScope","$location","registration","conference","$modal","$http","RegistrationCache",function($scope,$rootScope,$location,registration,conference,$modal,$http,RegistrationCache){function setRegistrationAsCompleted(){registration.completed=!0,_.isNull(registration.totalDue)&&(registration.totalDue=$rootScope.totalDue),$http.put("registrations/"+registration.id,registration).success(function(){$scope.registration.completed=!0}).error(function(data){alert("Error: "+data)})}$scope.conference=conference,$scope.registration=registration,$scope.answers=registration.answers,$scope.blocks=[],angular.forEach(conference.registrationPages,function(page){angular.forEach(page.blocks,function(block){-1===block.type.indexOf("Content")&&$scope.blocks.push(block)})}),$scope.findAnswer=function(blockId){return _.find($scope.answers,{blockId:blockId})},$scope.confirmRegistration=function(){if($(".btn-success").attr("value","Loading..."),!conference.acceptCreditCards)return void setRegistrationAsCompleted();var currentPayment=$rootScope.currentPayment;currentPayment.readyToProcess=!0,$http.post("payments/",currentPayment).success(function(){setRegistrationAsCompleted(),delete $rootScope.currentPayment,RegistrationCache.emptyCache()}).error(function(){var errorModalOptions={templateUrl:"views/errorModal.html",controller:"errorModal",backdrop:"static",keyboard:!1,resolve:{message:function(){return"Your card was declined, please verify and re-enter your details or use a different card."}}};$modal.open(errorModalOptions).result.then(function(){$location.path("/payment/"+conference.id)})})},$scope.editRegistration=function(){$location.path("/register/"+conference.id+"/page/"+conference.registrationPages[0].id)},$scope.editPayment=function(){$location.path("/payment/"+conference.id)}}]),angular.module("confRegistrationWebApp").directive("formElements",function(){return{restrict:"A",link:function(scope){var newDragBlock="";$(".connectedSortable").sortable({connectWith:".connectedSortable",placeholder:"crs-dragBack",stop:function(event,ui){""!==newDragBlock?(scope.insertBlock(newDragBlock,ui.item.parent().attr("id"),ui.item.index()),ui.item.parent().find("li:last").remove()):scope.moveBlock(ui.item.find(".crsQuestion").attr("id"),ui.item.parent().attr("id"),ui.item.index())}}),$(".crs-accordionSub li").draggable({connectToSortable:".connectedSortable",helper:"clone",revert:"invalid",addClasses:!1,appendTo:"body",start:function(){newDragBlock=$(this).attr("id")},stop:function(){newDragBlock=""}}).disableSelection()}}}),angular.module("confRegistrationWebApp").directive("accordionSub",function(){return{restrict:"A"}}).directive("scrollPosition",["$window",function($window){return function(scope){var windowEl=angular.element($window);windowEl.on("scroll",function(){scope.$apply(function(){var returnTop;returnTop=windowEl.scrollTop()>130?windowEl.scrollTop()-90:0,scope.scrollStyle=function(){return{marginTop:returnTop+"px"}}})})}}]),angular.module("confRegistrationWebApp").controller("AdminWizardCtrl",["$scope","$modal","conference","Model","GrowlService",function($scope,$modal,conference,Model,GrowlService){Model.subscribe($scope,"conference","conferences/"+conference.id),$scope.deletePage=function(pageId,growl){if(growl){var page=_.find($scope.conference.registrationPages,{id:pageId}),message='Page "'+page.title+'" has been deleted.';GrowlService.growl("conferences/"+$scope.conference.id,$scope.conference,message)}$scope.deletePageFromConf(pageId)},$scope.deletePageFromConf=function(pageId){var delPageIndex=_.findIndex($scope.conference.registrationPages,{id:pageId});$scope.conference.registrationPages.splice(delPageIndex,1)}}]),angular.module("confRegistrationWebApp").service("AnswerCache",["$cacheFactory","$rootScope","$http","$q",function($cacheFactory,$rootScope,$http,$q){var cache=$cacheFactory("answers"),blockIndex=$cacheFactory("blockIndex"),path=function(id){return"answers/"+(id||"")},update=function(path,object){updateServer(object),cache.put(path,object),blockIndex.put(object.block,object),$rootScope.$broadcast(path,object)},updateServer=function(answer){$http.put(path(answer.id),answer)},checkCache=function(path,callback){var cachedObject=cache.get(path);angular.isDefined(cachedObject)?callback(cachedObject,path):$http.get(path).success(function(conferences){cache.put(path,conferences),callback(conferences,path)})};this.query=function(id){checkCache(path(id),function(conferences,path){$rootScope.$broadcast(path,conferences)})},this.get=function(id){var defer=$q.defer();return checkCache(path(id),function(conferences){defer.resolve(conferences)}),defer.promise},this.put=function(answer){cache.put(path(answer.id),answer)},this.syncBlock=function(scope,name){scope.$watch(name,function(answer){angular.isDefined(answer)&&update(path(answer.id),answer)},!0)}}]),angular.module("confRegistrationWebApp").service("RegistrationCache",["$cacheFactory","$rootScope","$http","$q","AnswerCache",function($cacheFactory,$rootScope,$http,$q,AnswerCache){var cache=$cacheFactory("registration"),path=function(id){return"registrations/"+(id||"")},update=function(path,object){cache.put(path,object),$rootScope.$broadcast(path,object)},checkCache=function(path,callback){var cachedObject=cache.get(path);angular.isDefined(cachedObject)?callback(cachedObject,path):$http.get(path).success(function(data){update(path,data),callback(data,path)})};this.query=function(id){checkCache(path(id),function(conferences,path){$rootScope.$broadcast(path,conferences)})},this.emptyCache=function(){cache.removeAll()},this.get=function(id){var defer=$q.defer();return checkCache(path(id),defer.resolve),defer.promise},this.getCurrent=function(conferenceId){var defer=$q.defer();return checkCache("conferences/"+conferenceId+"/registrations/current",function(registration){update(path(registration.id),registration),angular.forEach(registration.answers,AnswerCache.put),defer.resolve(registration)}),defer.promise},this.getAllForConference=function(conferenceId){var defer=$q.defer();return checkCache("conferences/"+conferenceId+"/registrations",function(registrations){angular.forEach(registrations,function(registration){update(path(registration.id),registration)}),defer.resolve(registrations)}),defer.promise}}]),angular.module("confRegistrationWebApp").service("ConfCache",["$cacheFactory","$rootScope","$http","$q","uuid",function($cacheFactory,$rootScope,$http,$q,uuid){var cache=$cacheFactory("conf"),path=function(id){return"conferences/"+(id||"")},checkCache=function(path,callback){var cachedConferences=cache.get(path);angular.isDefined(cachedConferences)?callback(cachedConferences,path):$http.get(path).success(function(conferences){cache.put(path,conferences),callback(conferences,path)})};this.query=function(id){checkCache(path(id),function(conferences,path){$rootScope.$broadcast(path,conferences)})},this.get=function(id){var defer=$q.defer();return checkCache(path(id),function(conferences){defer.resolve(conferences)
}),defer.promise},this.create=function(name){var registrationEndTime=new Date;registrationEndTime.setYear(registrationEndTime.getFullYear()+1);var data={name:name,registrationStartTime:new Date,registrationEndTime:registrationEndTime,contactPersonName:""};return $http.post(path(),data).then(function(response){if(201===response.status){var conference=response.data;return conference.registrationPages[0]={id:uuid(),conferenceId:conference.id,position:0,title:"First Page",blocks:[]},cache.put(path(conference.id),conference),conference}alert("Error creating conference. "+response.data.errorMessage+": "+response.data.customErrorMessage)})}}]),angular.module("confRegistrationWebApp").service("ProfileCache",["$cacheFactory","$rootScope","$http","$q",function($cacheFactory,$rootScope,$http,$q){var cache=$cacheFactory("profile"),path="/profile",checkCache=function(path,callback){var cachedObject=cache.get(path);angular.isDefined(cachedObject)?callback(cachedObject,path):$http.get(path).success(function(profileData){cache.put(path,profileData),callback(profileData,path)})};this.get=function(){var defer=$q.defer();return checkCache(path,function(profileData){defer.resolve(profileData)}),defer.promise},this.getCache=function(callback){checkCache(path,function(profileData){callback(profileData)})}}]),angular.module("confRegistrationWebApp").controller("CreateConferenceDialogCtrl",["$scope","ConfCache","$modalInstance","defaultValue",function($scope,ConfCache,$modalInstance,defaultValue){$scope.name=defaultValue,$scope.close=function(){$modalInstance.close("")},$scope.submit=function(newConfName){$modalInstance.close(newConfName)}}]),angular.module("confRegistrationWebApp").controller("confirmCtrl",["$scope","ConfCache","$modalInstance",function($scope,ConfCache,$modalInstance){$scope.close=function(){$modalInstance.close(!1)},$scope.submit=function(){$modalInstance.close(!0)}}]),angular.module("confRegistrationWebApp").controller("confirmPromptCtrl",["$scope","$modalInstance",function($scope,$modalInstance){$scope.close=function(){$modalInstance.close("")},$scope.submit=function(newPageName){$modalInstance.close(newPageName)}}]),angular.module("confRegistrationWebApp").directive("ngEnter",function(){return function(scope,element,attrs){element.bind("keypress",function(event){13===event.which&&(scope.$apply(function(){scope.$eval(attrs.ngEnter)}),event.preventDefault())})}}),angular.module("confRegistrationWebApp").controller("FormDropAreaCtrl",["$rootScope","$scope","$modal","uuid","GrowlService",function($rootScope,$scope,$modal,uuid,GrowlService){function makePositionArray(){var tempPositionArray=[];return $scope.conference.registrationPages.forEach(function(page,pageIndex){page.blocks.forEach(function(block,blockIndex){tempPositionArray[block.id]={page:pageIndex,block:blockIndex}})}),tempPositionArray}$scope.$on("dragVars",function(event,x){$scope.blockId=x.blockId,$scope.moveType=x.moveType}),$scope.moveBlock=function(blockId,newPage,newPosition){var tempPositionArray=makePositionArray(),newPageIndex=_.findIndex($scope.conference.registrationPages,{id:newPage}),origPageIndex=tempPositionArray[blockId].page,origBlock=$scope.conference.registrationPages[origPageIndex].blocks[tempPositionArray[blockId].block];origBlock.pageId=newPage,$scope.$apply(function(scope){scope.deleteBlock(blockId,!1),scope.conference.registrationPages[newPageIndex].blocks.splice(newPosition,0,origBlock)})},$scope.insertBlock=function(blockType,newPage,newPosition){var newPageIndex=_.findIndex($scope.conference.registrationPages,{id:newPage}),profileType=null;if(-1!==blockType.indexOf("-profile")&&(blockType=blockType.split("-"),profileType=blockType[2],blockType=blockType[0]),!_.isNull(profileType)){var blockArray=[];$scope.conference.registrationPages.forEach(function(page){page.blocks.forEach(function(block){blockArray.push(block.profileType)})}),-1!==blockArray.indexOf(profileType)&&(alert("Only one "+profileType.charAt(0).toUpperCase()+profileType.slice(1).toLowerCase()+" profile block can be used per form."),profileType=null)}var newBlock={id:uuid(),content:"",pageId:newPage,required:!1,title:"New "+blockType+" Block",type:blockType,profileType:profileType};$scope.$apply(function(scope){scope.conference.registrationPages[newPageIndex].blocks.splice(newPosition,0,newBlock)})},$scope.deleteBlock=function(blockId,growl){if(growl){var t=makePositionArray(),block=$scope.conference.registrationPages[t[blockId].page].blocks[t[blockId].block],message='"'+block.title+'" has been deleted.';GrowlService.growl("conferences/"+$scope.conference.id,$scope.conference,message)}$scope.deleteBlockFromPage(blockId)},$scope.deleteBlockFromPage=function(blockId){var tempPositionArray=makePositionArray();$scope.conference.registrationPages[tempPositionArray[blockId].page].blocks.splice(tempPositionArray[blockId].block,1)},$scope.addNewPage=function(){$modal.open({templateUrl:"views/promptNewPage.html",controller:"confirmPromptCtrl"}).result.then(function(pageTitle){null===pageTitle||""===pageTitle||angular.isUndefined(pageTitle)||$scope.conference.registrationPages.push({id:uuid(),conferenceId:$scope.conference.id,position:0,title:pageTitle,blocks:[]})})}}]),angular.module("confRegistrationWebApp").constant("enforceAuth",function($route,$modal,$cookies,$q,$window,apiUrl,$http){var defer=$q.defer(),noAuthControllers=["RegistrationCtrl","paymentCtrl","ReviewRegistrationCtrl"],loginDialogOptions={templateUrl:"views/loginDialog.html",controller:"LoginDialogCtrl",backdrop:"static",keyboard:!1};return noAuthControllers.indexOf($route.current.$$route.controller)>=0?angular.isDefined($cookies.crsToken)&&""!==$cookies.crsToken?defer.resolve("Authorization present."):$http.get("conferences/"+$route.current.params.conferenceId).success(function(conference){conference.requireLogin?$modal.open(loginDialogOptions):$window.location.href=apiUrl+"auth/none/login"}):angular.isDefined($cookies.crsToken)&&""!==$cookies.crsToken&&"NONE"!==$cookies.crsAuthProviderType?defer.resolve("Authorization present."):$modal.open(loginDialogOptions),defer.promise}),angular.module("confRegistrationWebApp").controller("LoginDialogCtrl",["$scope","$window","apiUrl",function($scope,$window,apiUrl){$scope.apiUrl=apiUrl,$scope.submit=function(email){$window.location.href=apiUrl+"auth/none/login?email="+email}}]),angular.module("confRegistrationWebApp").directive("showAnswer",["AnswerCache","$modal","$location",function(AnswerCache,$modal,$location){return{templateUrl:"views/adminAnswerDisplay.html",restrict:"E",scope:{answers:"=",block:"="},controller:["$scope",function($scope){-1!==$location.$$path.indexOf("adminData/")&&($scope.answerEditable=!0);var editAnswerDialogOptions={templateUrl:"views/editAnswer.html",controller:"EditAnswerDialogCtrl",scope:$scope};$scope.createEditDialog=function(){$scope.answerEditable&&$modal.open(editAnswerDialogOptions).result.then(function(){AnswerCache.syncBlock($scope,"answer")})},$scope.$watch("answers",function(){if($scope.answers){var answerObject=_.find($scope.answers,{blockId:$scope.block.id});answerObject&&($scope.answer=answerObject)}}),$scope.getSelectedCheckboxes=function(choices){return _.keys(_.pick(choices,function(val){return val===!0}))}}]}}]),angular.module("confRegistrationWebApp").filter("joiner",function(){return function(input,separator){return angular.isArray(input)?input.join(separator||", "):input}}),angular.module("confRegistrationWebApp").service("Model",["$cacheFactory","$rootScope","$http","$q",function($cacheFactory,$rootScope,$http,$q){var cache=$cacheFactory("cache"),thisModel=this;this.create=function(path,object){return $http.post(path,object).then(function(response){var createdObjectPath=response.headers("Location"),createdObject=response.data;return cache.put(createdObjectPath,createdObject),cache.get(path)&&thisModel.get(path).then(function(parentCollection){parentCollection.push(createdObject),cache.put(path,parentCollection),$rootScope.$broadcast(path,parentCollection)}),angular.copy(createdObject)})},this.get=function(path){return cache.get(path)?$q.when(angular.copy(cache.get(path))):$http.get(path).then(function(response){return cache.put(path,response.data),angular.copy(response.data)})},this.delete=function(path){$http.delete(path).then(function(){cache.remove(path),$rootScope.$broadcast(path);var match=/\/?(.*\/)(.+)$/.exec(path),parentPath=match[1],removedObjectId=match[2];cache.get(parentPath)&&thisModel.get(parentPath).then(function(oldParentCollection){var parentCollection=_.reject(oldParentCollection,{id:removedObjectId});cache.put(parentPath,parentCollection),$rootScope.$broadcast(parentPath,parentCollection)})})},this.subscribe=function(scope,name,path){scope.$watch(name,function(object){if(angular.isDefined(object)){var cb=function(){cache.put(path,angular.copy(object)),$rootScope.$broadcast(path,object,scope.$id)};thisModel.update(path,object,cb)}},!0),scope.$on(path,function(event,object,originScopeId){scope.$id!==originScopeId&&(scope[name]=angular.copy(object))}),thisModel.get(path).then(function(object){scope[name]=angular.copy(object)})},this.update=function(path,object,cb){var callback=cb||function(){cache.put(path,angular.copy(object)),$rootScope.$broadcast(path,object)};angular.equals(object,cache.get(path))||$http.put(path,object).then(callback)}}]),angular.module("confRegistrationWebApp").controller("ConferenceCardCtrl",["$scope","$rootScope",function($scope,$rootScope){$scope.$on("flipevent",function(event,idToFlip){$scope.flip=$scope.$id!==idToFlip||$scope.flip?"":"js-flip"}),$scope.flipCard=function(){$rootScope.$broadcast("flipevent",$scope.$id)}}]),angular.module("confRegistrationWebApp").directive("body",function(){var matchRouteToClass={};return matchRouteToClass["/$"]="page--home",matchRouteToClass["/wizard/*."]="page--wizard",matchRouteToClass["/adminData/*."]="page--admin",matchRouteToClass["/register/*.*/page/*.*"]="page--register",matchRouteToClass["/adminDetails/*."]="page--admin-details",{restrict:"E",link:function(scope,element){scope.$on("$locationChangeSuccess",function(event,location){angular.forEach(matchRouteToClass,function(cssClass,regExpString){element.removeClass(cssClass),new RegExp(regExpString).test(location)&&element.addClass(cssClass)})})}}}),angular.module("confRegistrationWebApp").directive("crsDatetimepicker",function(){return{templateUrl:"views/datepicker.html",restrict:"E",scope:{localModel:"=model"},controller:["$timeout","$scope",function($timeout,$scope){$scope.showWeeks=!1,$scope.minDate=$scope.minDate?null:new Date,$scope.dateOptions={"starting-day":0},$scope.open=function(){$timeout(function(){$scope.opened=!0})}}]}}),angular.module("confRegistrationWebApp").directive("formDropArea",function(){return{restrict:"A",controller:"FormDropAreaCtrl"}}),angular.module("confRegistrationWebApp").controller("errorModal",["$scope","$modalInstance","message",function($scope,$modalInstance,message){$scope.message=message,$scope.close=function(){$modalInstance.close("")}}]),angular.module("confRegistrationWebApp").controller("paymentCtrl",["$scope","$rootScope","$location","registration","conference","$http","$modal","RegistrationCache",function($scope,$rootScope,$location,registration,conference,$http,$modal,RegistrationCache){$scope.currentYear=(new Date).getFullYear(),registration.completed?(registration.remainingBalance=registration.totalDue,registration.pastPayments.forEach(function(payment){registration.remainingBalance-=payment.amount}),$scope.amount=registration.remainingBalance,conference.conferenceCost=$scope.amount):(conference.conferenceCost=conference.earlyRegistrationOpen?conference.conferenceCost-conference.earlyRegistrationAmount:conference.conferenceCost,$rootScope.totalDue=conference.conferenceCost,$scope.amount=conference.minimumDeposit),$scope.currentRegistration=registration,$scope.conference=conference,$scope.createPayment=function(){var errorModalOptions={};if(!$scope.creditCardNameOnCard)return errorModalOptions={templateUrl:"views/errorModal.html",controller:"errorModal",resolve:{message:function(){return"Please enter the name on your card."}}},void $modal.open(errorModalOptions);if(!$scope.creditCardNumber)return errorModalOptions={templateUrl:"views/errorModal.html",controller:"errorModal",resolve:{message:function(){return"Please enter your card number."}}},void $modal.open(errorModalOptions);if(!$scope.creditCardExpirationMonth||!$scope.creditCardExpirationYear)return errorModalOptions={templateUrl:"views/errorModal.html",controller:"errorModal",resolve:{message:function(){return"Please enter card expiration date."}}},void $modal.open(errorModalOptions);if($rootScope.currentPayment={},$rootScope.currentPayment.amount=$scope.amount,$rootScope.currentPayment.registrationId=registration.id,$rootScope.currentPayment.creditCardNameOnCard=$scope.creditCardNameOnCard,$rootScope.currentPayment.creditCardExpirationMonth=$scope.creditCardExpirationMonth,$rootScope.currentPayment.creditCardExpirationYear=$scope.creditCardExpirationYear,$rootScope.currentPayment.creditCardNumber=$scope.creditCardNumber,$rootScope.currentPayment.creditCardCVVNumber=$scope.creditCardCVVNumber,registration.completed){var currentPayment=$rootScope.currentPayment;currentPayment.readyToProcess=!0,$http.post("payments/",currentPayment).success(function(){RegistrationCache.emptyCache(),$location.path("/register/"+conference.id)}).error(function(){var errorModalOptions={templateUrl:"views/errorModal.html",controller:"errorModal",backdrop:"static",keyboard:!1,resolve:{message:function(){return"Your card was declined, please verify and re-enter your details or use a different card."}}};$modal.open(errorModalOptions).result.then(function(){})})}else $location.path("/reviewRegistration/"+conference.id)}}]),angular.module("confRegistrationWebApp").directive("adminNav",function(){return{templateUrl:"views/adminNav.html",restrict:"A",controller:["$scope","$modal",function($scope,$modal){$scope.deleteConference=function(conferenceToDelete){$modal.open({templateUrl:"views/confirmDeleteConf.html",controller:"confirmCtrl"}).result.then(function(result){result&&alert("delete "+conferenceToDelete)})}}]}}),angular.module("confRegistrationWebApp").controller("AdminPermissionsCtrl",["$scope","conference","$http",function($scope,conference,$http){$scope.conference=conference;var getPermissions=function(){$http({method:"GET",url:"conferences/"+conference.id+"/permissions"}).success(function(data){$scope.currentPermissions=data}).error(function(){})};getPermissions(),$scope.updatePermission=function(id){$http({method:"PUT",url:"permissions/"+id,data:_.find($scope.currentPermissions,{id:id})}).success(function(){}).error(function(){})},$scope.addPermission=function(){var postData={conferenceId:conference.id,emailAddress:$scope.addPermissionsEmail,permissionLevel:$scope.addPermissionsLevel};$http({method:"POST",url:"conferences/"+conference.id+"/permissions",data:postData}).success(function(){getPermissions(),$scope.addPermissionsEmail="",$scope.addPermissionsLevel=""}).error(function(){})},$scope.deletePermission=function(id){$http({method:"DELETE",url:"permissions/"+id}).success(function(){getPermissions()}).error(function(){})}}]),angular.module("confRegistrationWebApp").controller("ActiviatePermissionCtrl",["$scope","$route","$http","$location","$timeout",function($scope,$route,$http,$location,$timeout){var permissionAuthCode=$route.current.params.permissionAuthCode;$scope.message="Verifying Auth Code...",$http({method:"PUT",url:"permissions/"+permissionAuthCode+"/accept",data:"{}"}).success(function(){$scope.message="Success! Permission has been granted.  Redirecting now...",$timeout(function(){$location.path("/")},2e3)}).error(function(data,status){404===status?$scope.message="Error: Permission auth code was not found.":403===status&&($scope.message="Error: Permission auth code has already been used or is more than 2 months old.")})}]),angular.module("confRegistrationWebApp").directive("nameQuestion",function(){return{templateUrl:"views/nameQuestion.html",restrict:"E"}}),angular.module("confRegistrationWebApp").directive("addressQuestion",function(){return{templateUrl:"views/addressQuestion.html",restrict:"E"}}),angular.module("confRegistrationWebApp").directive("checkboxQuestion",function(){return{templateUrl:"views/checkboxQuestion.html",restrict:"E"}}),angular.module("confRegistrationWebApp").directive("emailQuestion",function(){return{templateUrl:"views/emailQuestion.html",restrict:"E"}}),angular.module("confRegistrationWebApp").directive("numberQuestion",function(){return{templateUrl:"views/numberQuestion.html",restrict:"E"}}),angular.module("confRegistrationWebApp").directive("phoneQuestion",function(){return{templateUrl:"views/phoneQuestion.html",restrict:"E",link:function(scope,elements){elements.find("input").bind("blur",function(){scope.updateAnswer()})}}}),angular.module("confRegistrationWebApp").directive("radioQuestion",function(){return{templateUrl:"views/radioQuestion.html",restrict:"E"}}),angular.module("confRegistrationWebApp").directive("selectQuestion",function(){return{templateUrl:"views/selectQuestion.html",restrict:"E",link:function(scope,elements){elements.find("input").bind("blur",function(){scope.updateAnswer()})}}}),angular.module("confRegistrationWebApp").directive("textQuestion",function(){return{templateUrl:"views/textQuestion.html",restrict:"E"}});